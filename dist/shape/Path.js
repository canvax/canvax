"use strict";!function(t,e){if("function"==typeof define&&define.amd)define(["exports","../display/Shape","../utils/index","mmvis","../geom/Matrix","../math/index"],e);else if("undefined"!=typeof exports)e(exports,require("../display/Shape"),require("../utils/index"),require("mmvis"),require("../geom/Matrix"),require("../math/index"));else{var s={};e(s,t.Shape,t.index,t.mmvis,t.Matrix,t.index),t.undefined=s}}(void 0,function(t,e,s,i,a,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(e);n(s),n(a);function n(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l,b,d,m=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(y,r.default),l=y,(b=[{key:"watch",value:function(t){"path"==t&&this.graphics.clear()}},{key:"_parsePathData",value:function(t){if(this.__parsePathData)return this.__parsePathData;if(!t)return[];this.__parsePathData=[];var e=i._.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),s=this;return i._.each(e,function(t){s.__parsePathData.push(s._parseChildPathData(t))}),this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e,s=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(s=(s=(s=(s=s.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),e=0;e<i.length;e++)s=s.replace(new RegExp(i[e],"g"),"|"+i[e]);var a=s.split("|"),r=[],n=0,h=0;for(e=1;e<a.length;e++){var o=a[e],f=o.charAt(0),u=(o=(o=o.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");0<u.length&&""===u[0]&&u.shift();for(var c=0;c<u.length;c++)u[c]=parseFloat(u[c]);for(;0<u.length&&!isNaN(u[0]);){var p,l,b,d=null,m=[],y=n,v=h;switch(f){case"l":n+=u.shift(),h+=u.shift(),d="L",m.push(n,h);break;case"L":n=u.shift(),h=u.shift(),m.push(n,h);break;case"m":n+=u.shift(),h+=u.shift(),d="M",m.push(n,h),f="l";break;case"M":n=u.shift(),h=u.shift(),d="M",m.push(n,h),f="L";break;case"h":n+=u.shift(),d="L",m.push(n,h);break;case"H":n=u.shift(),d="L",m.push(n,h);break;case"v":h+=u.shift(),d="L",m.push(n,h);break;case"V":h=u.shift(),d="L",m.push(n,h);break;case"C":m.push(u.shift(),u.shift(),u.shift(),u.shift()),n=u.shift(),h=u.shift(),m.push(n,h);break;case"c":m.push(n+u.shift(),h+u.shift(),n+u.shift(),h+u.shift()),n+=u.shift(),h+=u.shift(),d="C",m.push(n,h);break;case"S":p=n,l=h,"C"===(b=r[r.length-1]).command&&(p=n+(n-b.points[2]),l=h+(h-b.points[3])),m.push(p,l,u.shift(),u.shift()),n=u.shift(),h=u.shift(),d="C",m.push(n,h);break;case"s":p=n,l=h,"C"===(b=r[r.length-1]).command&&(p=n+(n-b.points[2]),l=h+(h-b.points[3])),m.push(p,l,n+u.shift(),h+u.shift()),n+=u.shift(),h+=u.shift(),d="C",m.push(n,h);break;case"Q":m.push(u.shift(),u.shift()),n=u.shift(),h=u.shift(),m.push(n,h);break;case"q":m.push(n+u.shift(),h+u.shift()),n+=u.shift(),h+=u.shift(),d="Q",m.push(n,h);break;case"T":p=n,l=h,"Q"===(b=r[r.length-1]).command&&(p=n+(n-b.points[0]),l=h+(h-b.points[1])),n=u.shift(),h=u.shift(),d="Q",m.push(p,l,n,h);break;case"t":p=n,l=h,"Q"===(b=r[r.length-1]).command&&(p=n+(n-b.points[0]),l=h+(h-b.points[1])),n+=u.shift(),h+=u.shift(),d="Q",m.push(p,l,n,h);break;case"A":y=n,v=h,d="A",m=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),n=u.shift(),h=u.shift(),y,v];break;case"a":y=n,v=h,d="A",m=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),n+=u.shift(),h+=u.shift(),y,v]}r.push({command:d||f,points:m})}"z"!==f&&"Z"!==f||r.push({command:"z",points:[]})}return r}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),s=0,i=e.length;s<i;s++)for(var a=0,r=e[s].length;a<r;a++){var n=e[s][a].command,h=e[s][a].points;switch(n){case"L":t.lineTo(h[0],h[1]);break;case"M":t.moveTo(h[0],h[1]);break;case"C":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"Q":t.quadraticCurveTo(h[0],h[1],h[2],h[3]);break;case"A":o.Arc.drawArc(t,h[7],h[8],h);break;case"z":t.closePath()}}return this}}])&&f(l.prototype,b),void(d&&f(l,d)),y);function y(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);var e=i._.extend(!0,{pointList:[],path:""},t.context);return t.context=e,t.__parsePathData=null,t.type="path",u(this,c(y).call(this,t))}t.default=m});