"use strict";!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../../../math/index","../../../geom/Matrix","../../../const","../../../settings","pixi-gl-core"],t);else if("undefined"!=typeof exports)t(exports,require("../../../math/index"),require("../../../geom/Matrix"),require("../../../const"),require("../../../settings"),require("pixi-gl-core"));else{var i={};t(i,e.index,e.Matrix,e._const,e.settings,e.pixiGlCore),e.undefined=i}}(void 0,function(e,a,t,i,r,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=h(t),o=h(r);function h(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f,l,d,c=h(s).default.GLFramebuffer,m=(f=F,(l=[{key:"clear",value:function(e){var t=e||this.clearColor;this.frameBuffer.clear(t[0],t[1],t[2],t[3])}},{key:"setFrame",value:function(e,t){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e}},{key:"activate",value:function(){var e=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.destinationFrame!==this.sourceFrame?(e.enable(e.SCISSOR_TEST),e.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):e.disable(e.SCISSOR_TEST),e.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)}},{key:"calculateProjection",value:function(e,t){var i=this.projectionMatrix;t=t||e,i.identity(),i.a=1/e.width,i.d=-1/e.height,i.tx=-1-t.x*i.a,i.ty=1-t.y*i.d}},{key:"resize",value:function(e,t){if(e|=0,t|=0,this.size.width!==e||this.size.height!==t){this.size.width=e,this.size.height=t,this.defaultFrame.width=e,this.defaultFrame.height=t,this.frameBuffer.resize(e*this.resolution,t*this.resolution);var i=this.frame||this.size;this.calculateProjection(i)}}},{key:"destroy",value:function(){this.frameBuffer.destroy(),this.frameBuffer=null}}])&&u(f.prototype,l),void(d&&u(f,d)),F);function F(e,t,i,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,F),this.gl=e,this.frameBuffer=null,this.clearColor=[0,0,0,0],this.size=new a.Rectangle(0,0,1,1),this.resolution=r||o.default.RESOLUTION,this.projectionMatrix=new n.default,this.frame=null,this.defaultFrame=new a.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.root=s,this.frameBuffer=new c(e,100,100),this.frameBuffer.framebuffer=null,this.setFrame(),this.resize(t,i)}e.default=m});