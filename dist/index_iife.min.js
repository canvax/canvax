var canvax=function(){"use strict";var c=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var f=t(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}e.exports=n});var s=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var o=function(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?s(t):e},l=t(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n}),n=t(function(n){function i(t,e){return n.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}n.exports=i});function u(t){var e=O(t);return"number"==typeof e&&0<=e&&e<=E}var e,d=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)},x={},p={},r=Array.prototype,a=Object.prototype,v=r.push,g=r.slice,y=r.concat,_=a.toString,m=a.hasOwnProperty,w=r.forEach,b=r.map,k=r.filter,T=r.every,C=r.some,P=r.indexOf,A=Array.isArray,S=Object.keys,E=Math.pow(2,53)-1,O=(e="length",function(t){return null==t?void 0:t[e]});x.values=function(t){for(var e=x.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},x.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)x.has(t,n)&&e.push(n);return e},x.has=function(t,e){return m.call(t,e)};var I=x.each=x.forEach=function(t,e,n){if(null!=t)if(w&&t.forEach===w)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t)===p)return}else{var a=x.keys(t);for(i=0,r=a.length;i<r;i++)if(e.call(n,t[a[i]],a[i],t)===p)return}};x.compact=function(t){return x.filter(t,x.identity)},x.filter=x.select=function(t,i,r){var a=[];return null==t?a:k&&t.filter===k?t.filter(i,r):(I(t,function(t,e,n){i.call(r,t,e,n)&&a.push(t)}),a)},I(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return _.call(t)=="[object "+e+"]"}}),x.isArguments=function(t){return!(!t||!x.has(t,"callee"))},"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==_.call(t)},x.isNull=function(t){return null===t},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=A||function(t){return"[object Array]"==_.call(t)},x.isObject=function(t){return t===Object(t)},x.identity=function(t){return t},x.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return t[i=x.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,r+n):n}if(P&&t.indexOf===P)return t.indexOf(e,n);for(;i<r;i++)if(t[i]===e)return i;return-1},x.isWindow=function(t){return null!=t&&t==t.window};x.flatten=function(t,e){return function e(t,n,i){return n&&x.every(t,x.isArray)?y.apply(i,t):(I(t,function(t){x.isArray(t)||x.isArguments(t)?n?v.apply(i,t):e(t,n,i):i.push(t)}),i)}(t,e,[])},x.every=x.all=function(t,i,r){i=i||x.identity;var a=!0;return null==t?a:T&&t.every===T?t.every(i,r):(I(t,function(t,e,n){if(!(a=a&&i.call(r,t,e,n)))return p}),!!a)},x.min=function(t,r,a){if(!r&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!r&&x.isEmpty(t))return 1/0;var s={computed:1/0,value:1/0};return I(t,function(t,e,n){var i=r?r.call(a,t,e,n):t;i<s.computed&&(s={value:t,computed:i})}),s.value},x.max=function(t,r,a){if(!r&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!r&&x.isEmpty(t))return-1/0;var s={computed:-1/0,value:-1/0};return I(t,function(t,e,n){var i=r?r.call(a,t,e,n):t;i>s.computed&&(s={value:t,computed:i})}),s.value},x.find=x.detect=function(t,i,r){var a;return M(t,function(t,e,n){if(i.call(r,t,e,n))return a=t,!0}),a};var M=x.some=x.any=function(t,i,r){i=i||x.identity;var a=!1;return null==t?a:C&&t.some===C?t.some(i,r):(I(t,function(t,e,n){if(a=a||i.call(r,t,e,n))return p}),!!a)};x.without=function(t){return x.difference(t,g.call(arguments,1))},x.difference=function(t){var e=y.apply(r,g.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.uniq=x.unique=function(n,i,t,e){x.isFunction(i)&&(e=t,t=i,i=!1);var r=t?x.map(n,t,e):n,a=[],s=[];return I(r,function(t,e){(i?e&&s[s.length-1]===t:x.contains(s,t))||(s.push(t),a.push(n[e]))}),a},x.map=x.collect=function(t,i,r){var a=[];return null==t?a:b&&t.map===b?t.map(i,r):(I(t,function(t,e,n){a.push(i.call(r,t,e,n))}),a)},x.contains=x.include=function(t,e){return null!=t&&(P&&t.indexOf===P?-1!=t.indexOf(e):M(t,function(t){return t===e}))},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},x.shuffle=function(t){return x.sample(t,1/0)},x.sample=function(t,e,n){if(null==e||n)return u(t)||(t=x.values(t)),t[x.random(t.length-1)];var i=u(t)?x.clone(t):x.values(t),r=O(i);e=Math.max(Math.min(e,r),0);for(var a=r-1,s=0;s<e;s++){var o=x.random(s,a),h=i[s];i[s]=i[o],i[o]=h}return i.slice(0,e)},x.extend=function(){var t,e,n,i,r=arguments[0]||{},a=1,s=arguments.length,o=!1;for("boolean"==typeof r&&(o=r,r=arguments[1]||{},a=2),"object"===f(r)||x.isFunction(r)||(r={}),s===a&&(r=this,--a);a<s;a++)if(null!=(t=arguments[a]))for(e in t)n=r[e],r!==(i=t[e])&&void 0!==i&&(o&&i&&x.isObject(i)&&i.constructor===Object?r[e]=x.extend(o,n,i):r[e]=i);return r},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend(!0,{},t):t},x.euclideanModulo=function(t,e){return(t%e+e)%e},x.DEG2RAD=Math.PI/180,x.RAD2DEG=180/Math.PI,x.degToRad=function(t){return t*x.DEG2RAD},x.radToDeg=function(t){return t*x.RAD2DEG};function L(a,s){if(document[a]){return function t(e,n,i){if(e.length)for(var r=0;r<e.length;r++)t(e[r],n,i);else e[a](n,i,!1)}}return function t(e,n,i){if(e.length)for(var r=0;r<e.length;r++)t(e[r],n,i);else e[s]("on"+n,function(){return i.call(e,window.event)})}}var D="undefined"!=typeof window?window.devicePixelRatio:1,R={query:function(t){return x.isString(t)?document.getElementById(t):1==t.nodeType?t:t.length?t[0]:null},offset:function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,r=n.documentElement,a=r.clientTop||i.clientTop||0,s=r.clientLeft||i.clientLeft||0,o=1;if(i.getBoundingClientRect){var h=i.getBoundingClientRect();o=(h.right-h.left)/i.clientWidth}return 1<o&&(s=a=0),{top:e.top/o+(window.pageYOffset||r&&r.scrollTop/o||i.scrollTop/o)-a,left:e.left/o+(window.pageXOffset||r&&r.scrollLeft/o||i.scrollLeft/o)-s}},addEvent:L("addEventListener","attachEvent"),removeEvent:L("removeEventListener","detachEvent"),pageX:function(t){return t.pageX?t.pageX:t.clientX?t.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null},pageY:function(t){return t.pageY?t.pageY:t.clientY?t.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null},createCanvas:function(t,e,n){var i=document.createElement("canvas");return i.style.position="absolute",i.style.width=t+"px",i.style.height=e+"px",i.style.left=0,i.style.top=0,i.setAttribute("width",t*D),i.setAttribute("height",e*D),i.setAttribute("id",n),i},createView:function(t,e){var n=document.createElement("div");n.className="canvax-view",n.style.cssText+="position:relative;width:100%;height:100%;";var i=document.createElement("div");i.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;";var r=document.createElement("div");return r.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;",n.appendChild(i),n.appendChild(r),{view:n,stageView:i,domView:r}}},B={mainFrameRate:60,now:0,_pixelCtx:null,__emptyFunc:function(){},_devicePixelRatio:"undefined"!=typeof window?window.devicePixelRatio:1,_UID:0,getUID:function(){return this._UID++},createId:function(t){var e=t.charCodeAt(t.length-1);return 48<=e&&e<=57&&(t+="_"),t+B.getUID()},canvasSupport:function(){return!!document.createElement("canvas").getContext},initElement:function(t){return window.FlashCanvas&&FlashCanvas.initElement&&FlashCanvas.initElement(t),t},getCssOrderArr:function(t){var e,n,i,r;return"number"==typeof t?e=n=i=r=t:t instanceof Array?1===t.length?e=n=i=r=t[0]:2===t.length?(e=i=t[0],n=r=t[1]):3===t.length?(e=t[0],n=r=t[1],i=t[2]):(e=t[0],n=t[1],i=t[2],r=t[3]):e=n=i=r=0,[e,n,i,r]},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!n||!n.getContextAttributes().stencil)}catch(t){return!1}},checkOpt:function(t){return t?t.context||(t.context={}):t={context:{}},t}};B._pixelCtx=B.initElement(R.createCanvas(1,1,"_pixelCanvas")).getContext("2d");function F(t){var e="CanvaxEvent";x.isString(t)&&(e=t),x.isObject(t)&&t.type&&(e=t.type,x.extend(this,t)),this.target=null,this.currentTarget=null,this.type=e,this.point=null;var n=this;this._stopPropagation=!1,this.stopPropagation=function(){n._stopPropagation=!0,x.isObject(t)&&(t._stopPropagation=!0)},this._preventDefault=!1,this.preventDefault=function(){n._preventDefault=!0,x.isObject(t)&&(t._preventDefault=!0)}}function $(){this._eventMap={}}var N="mousedown mouseup mouseover mousemove mouseout click dblclick wheel keydown keypress keyup",j={_types:N.split(/,| /),register:function(t){t&&(x.isString(t)&&(t=t.split(/,| /)),this._types=N.split(/,| /).concat(t))},get:function(){return this._types}};$.prototype={_setEventEnable:function(){if(!this.children){var t=!1;for(var e in this._eventMap)-1<x.indexOf(j.get(),e)&&(t=!0);this._eventEnabled=t}},_addEventListener:function(t,n){if("function"!=typeof n)return!1;var i=!0,r=this,e=t;return x.isString(t)&&(e=t.split(/,| /)),x.each(e,function(t){var e=r._eventMap[t];return e?-1==x.indexOf(e,n)?(e.push(n),r._setEventEnable(),!0):void(i=!1):((e=r._eventMap[t]=[]).push(n),r._setEventEnable(),!0)}),i},_removeEventListener:function(t,e){if(1==arguments.length)return this.removeEventListenerByType(t);var n=this._eventMap[t];if(!n)return!1;for(var i=0;i<n.length;i++){if(n[i]===e)return n.splice(i,1),0==n.length&&(delete this._eventMap[t],this._setEventEnable()),!0}return!1},_removeEventListenerByType:function(t){return!this._eventMap[t]&&(delete this._eventMap[t],this._setEventEnable(),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(t){var e=this._eventMap[t.type];if(e){t.target||(t.target=this),t.currentTarget||(t.currentTarget=this),e=e.slice();for(var n=0;n<e.length;n++){var i=e[n];"function"==typeof i&&i.call(this,t)}}return t._stopPropagation||this.parent&&(t.currentTarget=this.parent,this.parent._dispatchEvent(t)),!0},_hasEventListener:function(t){var e=this._eventMap[t];return null!=e&&0<e.length}};function W(t,e){this.canvax=t,this.curPoints=[{x:0,y:0}],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default",this.target=this.canvax.view,this.drag={start:"panstart",move:"panmove",end:"panend"},x.extend(!0,this,e)}var H=function(){function t(){return c(this,t),o(this,l(t).call(this))}return d(t,$),h(t,[{key:"on",value:function(t,e){return this._addEventListener(t,e),this}},{key:"addEventListener",value:function(t,e){return this._addEventListener(t,e),this}},{key:"un",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListener",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListenerByType",value:function(t){return this._removeEventListenerByType(t),this}},{key:"removeAllEventListeners",value:function(){return this._removeAllEventListeners(),this}},{key:"fire",value:function(t,e){var n=new F(t);if(e)for(var i in e)"type"!=i&&(n[i]=e[i]);var r=this;return x.each(t.split(" "),function(t){(n.currentTarget=r).dispatchEvent(n)}),this}},{key:"dispatchEvent",value:function(t){if(this.children&&t.point){var e=this.getObjectsUnderPoint(t.point,1)[0];e&&e.dispatchEvent(t)}else{if(!this.context||"mouseover"!=t.type){if(this._dispatchEvent(t),this.context&&"mouseout"==t.type&&this._hoverClass&&this.hoverClone){r=this.getStage().parent;this._hoverClass=!1,r._bufferStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)}return this}var n=this._heartBeatNum,i=this.context.$model.globalAlpha;if(this._dispatchEvent(t),n!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone)){var r=this.getStage().parent,a=this.clone(!0);a._transform=this.getConcatenatedMatrix(),r._bufferStage.addChildAt(a,0),this._globalAlpha=i,this.context.globalAlpha=0}}}},{key:"hasEvent",value:function(t){return this._hasEventListener(t)}},{key:"hasEventListener",value:function(t){return this._hasEventListener(t)}},{key:"hover",value:function(t,e){return this.on("mouseover",t),this.on("mouseout",e),this}},{key:"once",value:function(e,n){var i=this;return this.on(e,function t(){n.apply(i,arguments),this.un(e,t)}),this}}]),t}(),U=["pan","panstart","panmove","panend","pancancel","panleft","panright","panup","pandown","press","pressup","swipe","swipeleft","swiperight","swipeup","swipedown","tap"],V=document&&document.compareDocumentPosition?function(t,e){return!!e&&!!(16&t.compareDocumentPosition(e))}:function(t,e){return!!e&&(e!=e&&(!t.contains||t.contains(e)))};W.prototype={init:function(){var e=this;null==e.target.nodeType&&j.register(U),R.addEvent(e.target,"contextmenu",function(t){t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1}),x.each(j.get(),function(t){1==e.target.nodeType?R.addEvent(e.target,t,function(t){e.__mouseHandler(t)}):e.target.on(t,function(t){e.__libHandler(t)})})},__mouseHandler:function(t){var e=this,n=e.canvax;n.updateViewOffset(),e.curPoints=[{x:R.pageX(t)-n.viewOffset.left,y:R.pageY(t)-n.viewOffset.top}];var i=e.curPoints[0],r=e.curPointsTarget[0];if(-1<x.indexOf(["mousedown","mouseover","click"],t.type)&&!r){if(!r){var a=n.getObjectsUnderPoint(i,1)[0];a&&(e.curPointsTarget=[a])}r=e.curPointsTarget[0]}if("mousedown"==t.type&&r&&r.dragEnabled&&(e._touching=!0),"mouseup"!=t.type&&("mouseout"!=t.type||V(n.view,t.toElement||t.relatedTarget))||(1==e._draging&&(e._dragEnd(t,r,0),r.fire("dragend")),e._draging=!1,e._touching=!1),"mouseout"==t.type)V(n.view,t.toElement||t.relatedTarget)||e.__getcurPointsTarget(t,i,!0);else if("mousemove"==t.type)if(e._touching&&"mousemove"==t.type&&r){if(e._draging)e._dragIngHander(t,r,0);else r.fire("dragstart"),r._globalAlpha||(r._globalAlpha=r.context.$model.globalAlpha),r.context.globalAlpha=0,e._clone2hoverStage(r,0).context.globalAlpha=r._globalAlpha;e._draging=!0}else e.__getcurPointsTarget(t,i);else{var s=r;s=s||n,e.__dispatchEventInChilds(t,[s]),e._cursorHander(s)}(n.preventDefault||t._preventDefault)&&(t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1)},__getcurPointsTarget:function(t,e,n){var i=this,r=i.canvax,a=i.curPointsTarget[0];if(a&&!a.context&&(a=null),"mousemove"==(t=new F(t)).type&&a&&a._hoverClass&&a.hoverClone&&a.pointChkPriority&&a.getChildInPoint(e))return t.target=t.currentTarget=a,t.point=a.globalToLocal(e),void a.dispatchEvent(t);var s=n?null:r.getObjectsUnderPoint(e,1)[0];(a&&a!=s||"mouseout"==t.type)&&a&&a.context&&(i.curPointsTarget[0]=null,t.type="mouseout",t.toTarget=s,t.target=t.currentTarget=a,t.point=a.globalToLocal(e),a.dispatchEvent(t)),s&&a!=s&&(i.curPointsTarget[0]=s,t.type="mouseover",t.fromTarget=a,t.target=t.currentTarget=s,t.point=s.globalToLocal(e),s.dispatchEvent(t)),"mousemove"==t.type&&s&&(t.target=t.currentTarget=a,t.point=a.globalToLocal(e),a.dispatchEvent(t)),i._cursorHander(s,a)},_cursorHander:function(t,e){t||e||this._setCursor("default"),t&&e!=t&&t.context&&this._setCursor(t.context.$model.cursor)},_setCursor:function(t){this._cursor!=t&&(this.canvax.view.style.cursor=t,this._cursor=t)},__libHandler:function(n){var i=this,t=i.canvax;t.updateViewOffset(),i.curPoints=i.__getCanvaxPointInTouchs(n),i._draging||(i.curPointsTarget=i.__getChildInTouchs(i.curPoints)),0<i.curPointsTarget.length?(n.type==i.drag.start&&x.each(i.curPointsTarget,function(t,e){if(t&&t.dragEnabled)return i._draging=!0,t._globalAlpha||(t._globalAlpha=t.context.$model.globalAlpha),i._clone2hoverStage(t,e),t.context.globalAlpha=0,t.fire("dragstart"),!1}),n.type==i.drag.move&&i._draging&&x.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&i._dragIngHander(n,t,e)}),n.type==i.drag.end&&i._draging&&(x.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&(i._dragEnd(n,t,0),t.fire("dragend"))}),i._draging=!1),i.__dispatchEventInChilds(n,i.curPointsTarget)):i.__dispatchEventInChilds(n,[t])},__getCanvaxPointInTouchs:function(t){var e=this.canvax,n=[];return x.each(t.point,function(t){n.push({x:R.pageX(t)-e.viewOffset.left,y:R.pageY(t)-e.viewOffset.top})}),n},__getChildInTouchs:function(t){var e=this.canvax,n=[];return x.each(t,function(t){n.push(e.getObjectsUnderPoint(t,1)[0])}),n},__dispatchEventInChilds:function(i,t){if(!(t||"length"in t))return!1;var r=this;x.each(t,function(t,e){if(t){var n=new F(i);n.stagePoint=r.curPoints[e],n.point=t.globalToLocal(n.stagePoint),t.dispatchEvent(n)}})},_clone2hoverStage:function(t,e){var n=this.canvax,i=n._bufferStage.getChildById(t.id);return i||((i=t.clone(!0))._transform=t.getConcatenatedMatrix(),n._bufferStage.addChildAt(i,0)),i.context.globalAlpha=t._globalAlpha,t._dragPoint=t.globalToLocal(this.curPoints[e]),i},_dragIngHander:function(t,e,n){var i=this.canvax,r=e.globalToLocal(this.curPoints[n]);e._noHeart=!0;var a=e.moveing;e.moveing=!0,e.context.x+=r.x-e._dragPoint.x,e.context.y+=r.y-e._dragPoint.y,e.fire("draging"),e.moveing=a,e._noHeart=!1;var s=i._bufferStage.getChildById(e.id);s._transform=e.getConcatenatedMatrix(),s.worldTransform=null,s.heartBeat()},_dragEnd:function(t,e){var n=this.canvax._bufferStage.getChildById(e.id);n&&n.destroy(),e.context.globalAlpha=e._globalAlpha}};function X(t,e,n,i,r,a){this.a=null!=t?t:1,this.b=null!=e?e:0,this.c=null!=n?n:0,this.d=null!=i?i:1,this.tx=null!=r?r:0,this.ty=null!=a?a:0,this.array=null}var Y={Event:F,Dispatcher:H,Handler:W,Manager:$,types:j};X.prototype={concat:function(t){var e=this.a,n=this.c,i=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d,this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},concatTransform:function(t,e,n,i,r){var a=1,s=0;if(r%360){var o=r*Math.PI/180;a=Math.cos(o),s=Math.sin(o)}return this.concat(new X(a*n,s*n,-s*i,a*i,t,e)),this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,a=this.tx;if(0<t)this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e;else{var s=Math.sin(Math.abs(t)),o=Math.cos(Math.abs(t));this.a=i*o+this.b*s,this.b=-i*s+this.b*o,this.c=r*o+this.d*s,this.d=-r*s+o*this.d,this.tx=o*a+s*this.ty,this.ty=o*this.ty-s*a}return this},scale:function(t,e){return this.a*=t,this.d*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,a=t*i-e*n;return this.a=i/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-i*r)/a,this.ty=-(t*this.ty-e*r)/a,this},clone:function(){return new X(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(t,e){if(0==arguments.length)return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)?null:[this.a,this.b,this.c,this.d,this.tx,this.ty];this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0),n[8]=1,n},mulVector:function(t){var e=this.a,n=this.c,i=this.tx,r=this.b,a=this.d,s=this.ty,o=[0,0];return o[0]=t[0]*e+t[1]*n+i,o[1]=t[0]*r+t[1]*a+s,o}};var q,G,z=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(c(this,a),1==arguments.length&&"object"==f(arguments[0])){var n=arguments[0];if("x"in n&&"y"in n)this.x=+n.x,this.y=+n.y;else{var i=0;for(var r in n){if(0!=i){this.y=+n[r];break}this.x=+n[r],i++}}}else this.x=+t,this.y=+e}return h(a,[{key:"toArray",value:function(){return[this.x,this.y]}}]),a}(),Q=t(function(t,e){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(t=void 0!==t?t:o.now();0<n.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var r=this._tweens[n[i]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[n[i]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i,o=new n;o.Group=n,o._nextId=0,o.nextId=function(){return o._nextId++},"undefined"==typeof window&&"undefined"!=typeof process?o.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?o.now=window.performance.now.bind(window.performance):void 0!==Date.now?o.now=Date.now:o.now=function(){return(new Date).getTime()},o.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=o.Easing.Linear.None,this._interpolationFunction=o.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||o,this._id=o.nextId()},o.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=t,void 0!==e&&(this._duration=e),this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?o.now()+parseFloat(t):t:o.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,n,i;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration,n=0===this._duration||1<n?1:n,i=this._easingFunction(n),this._valuesEnd)if(void 0!==this._valuesStart[e]){var r=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this._object[e]=this._interpolationFunction(a,i):("string"==typeof a&&(a="+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),"number"==typeof a&&(this._object[e]=r+(a-r)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==n)return!0;if(0<this._repeat){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var s=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=s}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,h=this._chainedTweens.length;o<h;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}},o.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-o.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*o.Easing.Bounce.In(2*t):.5*o.Easing.Bounce.Out(2*t-1)+.5}}},o.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),a=o.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],i):1<e?a(t[n],t[n-1],n-i):a(t[r],t[n<r+1?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,a=o.Interpolation.Utils.Bernstein,s=0;s<=i;s++)n+=r(1-e,i-s)*r(e,s)*t[s]*a(i,s);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),a=o.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),a(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):1<e?t[n]-(a(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):a(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=o.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(i=[1],function(t){var e=1;if(i[t])return i[t];for(var n=t;1<n;n--)e*=n;return i[t]=e}),CatmullRom:function(t,e,n,i,r){var a=.5*(n-t),s=.5*(i-e),o=r*r;return(2*e-2*n+a+s)*(r*o)+(-3*e+3*n-2*a-s)*o+a*r+e}}},t.exports=o}),Z=0,J=!0;if("undefined"!=typeof window){q=window.requestAnimationFrame,G=window.cancelAnimationFrame;for(var K=["ms","moz","webkit","o"],tt=0;tt<K.length&&!window.requestAnimationFrame;++tt)q=window.requestAnimationFrame=window[K[tt]+"RequestAnimationFrame"],G=window.cancelAnimationFrame=window[K[tt]+"CancelAnimationFrame"]||window[K[tt]+"CancelRequestAnimationFrame"]}q=q||function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-Z)),i=setTimeout(function(){t(e+n)},n);return Z=e+n,i},G=G||function(t){clearTimeout(t)};var et=[],nt=null;function it(t){if(t)return et.push(t),nt=nt||q(function(){Q.update();var t=et;for(et=[],nt=null;0<t.length;)t.shift().task()})}function rt(t){for(var e=!1,n=0,i=et.length;n<i;n++)et[n].id===t.id&&(e=!0,et.splice(n,1),n--,i--);return 0==et.length&&(G(nt),nt=null),e}function at(){return J}var st={setAnimationEnabled:function(t){J=t},getAnimationEnabled:at,registFrame:it,destroyFrame:rt,registTween:function(t){var e=x.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},t);at()||(e.duration=0,e.delay=0);var n={},i="tween_"+B.getUID();if(e.id&&(i=i+"_"+e.id),e.from&&e.to){(n=new Q.Tween(e.from).to(e.to,e.duration).onStart(function(){e.onStart(e.from)}).onUpdate(function(){e.onUpdate(e.from)}).onComplete(function(){rt({id:i}),n._isCompleteed=!0,e.onComplete(e.from)}).onStop(function(){rt({id:i}),n._isStoped=!0,e.onStop(e.from)}).repeat(e.repeat).delay(e.delay).easing(Q.Easing[e.easing.split(".")[0]][e.easing.split(".")[1]])).id=i,n.start(),function t(){n._isCompleteed||n._isStoped?n=null:it({id:i,task:t,desc:e.desc,tween:n})}()}return n},destroyTween:function(t,e){t.stop()},Tween:Q,taskList:et};var ot=Object.defineProperty;try{ot({},"_",{value:"x"});var ht=Object.defineProperties}catch(t){"__defineGetter__"in Object&&(ot=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t},ht=function(t,e){for(var n in e)e.hasOwnProperty(n)&&ot(t,n,e[n]);return t})}var lt=0,ut=2,ct={POLY:0,RECT:1,CIRC:2,ELIP:3},ft=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin"],dt=["lineWidth","strokeAlpha","strokeStyle","fillStyle","fillAlpha","globalAlpha","shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur"],pt=function(t,e,n,i){var r=t[0],a=t[1],s=t[2],o=t[3],h=Math.max(i,3),l=0,u=r;return!(a+h<n&&o+h<n||n<a-h&&n<o-h||r+h<e&&s+h<e||e<r-h&&e<s-h)&&(r===s?Math.abs(e-r)<=h/2:((l=(a-o)/(r-s))*e-n+(u=(r*o-s*a)/(r-s)))*(l*e-n+u)/(l*l+1)<=h/2*h/2)};function vt(t,e,n){for(var i=t.shape.points,r=t.lineWidth,a=!1,s=0;s<i.length&&!(a=pt(i.slice(s,s+4),e,n,r));++s)s+=1;return a}var gt={RESOLUTION:"undefined"!=typeof window?window.devicePixelRatio:1,TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,FILTER_RESOLUTION:1,SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!0,forceFXAA:!1,autoResize:!1,transparent:!0,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump"},yt=function(){function i(t){var e;c(this,i),(e=o(this,l(i).call(this,t)))._transform=null,e.worldTransform=null,e._transformChange=!1,e._heartBeatNum=0,e.stage=null,e.parent=null,e.xyToInt=!("xyToInt"in t)||t.xyToInt,e.moveing=!1,e.clip=null,e.context=e._createContext(t),e.type=t.type||"DisplayObject",e.id=t.id||B.createId(e.type),e._trackList=[],e.init.apply(s(e),arguments),e._updateTransform(),e._tweens=[];var n=s(e);return e.on("destroy",function(){n.cleanAnimates()}),e}return d(i,Y.Dispatcher),h(i,[{key:"init",value:function(){}},{key:"clipTo",value:function(t){(this.clip=t).isClip=!0}},{key:"_createContext",value:function(t){var r=this,e=t.context||{},n={width:e.width||0,height:e.height||0,x:e.x||0,y:e.y||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1,scaleOrigin:e.scaleOrigin||{x:0,y:0},rotation:e.rotation||0,rotateOrigin:e.rotateOrigin||{x:0,y:0},visible:e.visible||!0,globalAlpha:e.globalAlpha||1};return x.extend(!0,n,t.context),r._notWatch=!1,r._noHeart=!1,n.$watch=function(t,e,n){var i=r;i.context&&("globalGalpha"==t&&(i._globalAlphaChange=!0),-1<x.indexOf(ft,t)&&(i._updateTransform(),i._transformChange=!0),i._notWatch||(i.$watch&&(i._notWatch=!0,i.$watch(t,e,n),i._notWatch=!1),i._noHeart||i.heartBeat({convertType:"context",shape:i,name:t,value:e,preValue:n})))},function o(e){var h=!0,l={},n={},i=["$watch","$model"],u={},r=i;function t(a,t){-1===x.indexOf(i,a)&&(u[a]=t);var s=f(t);if(!(-1<x.indexOf(r,a)))if("function"===s)r.push(a);else{var e=function(t){var e,n=u[a],i=n;if(!arguments.length)return!n||"object"!==s||n instanceof Array||n.$model||n.addColorStop||((n=o(n)).$watch=l.$watch,u[a]=n),n;var r=f(t);h||n!==t&&(!t||"object"!==r||t instanceof Array||t.addColorStop?n=t:e=(n=t.$model?t:o(t)).$model,u[a]=e||n,s!=r&&(s=r),l.$watch&&l.$watch.call(l,a,n,i))};n[a]={set:e,get:e,enumerable:!0}}}for(var a in e)t(a,e[a]);return l=ht(l,n,r),x.forEach(r,function(t){e[t]&&("function"==typeof e[t]?l[t]=function(){e[t].apply(this,arguments)}:l[t]=e[t])}),l.$model=u,l.hasOwnProperty=function(t){return t in l.$model},h=!1,l}(n)}},{key:"track",value:function(t){-1==x.indexOf(this._trackList,t)&&this._trackList.push(t)}},{key:"untrack",value:function(t){var e=x.indexOf(this._trackList,t);-1<e&&this._trackList.splice(e,1)}},{key:"clone",value:function(t){var e,n={id:this.id,context:x.clone(this.context.$model),isClone:!0};return(e="text"==this.type?new this.constructor(this.text,n):new this.constructor(n)).id=n.id,this.children&&(e.children=this.children),this.graphics&&(e.graphics=this.graphics.clone()),t||(e.id=B.createId(e.type)),e}},{key:"heartBeat",value:function(t){var e=this.getStage();e&&(this._heartBeatNum++,e.heartBeat&&e.heartBeat(t))}},{key:"getCurrentWidth",value:function(){return Math.abs(this.context.$model.width*this.context.$model.scaleX)}},{key:"getCurrentHeight",value:function(){return Math.abs(this.context.$model.height*this.context.$model.scaleY)}},{key:"getStage",value:function(){if(this.stage)return this.stage;var t=this;if("stage"!=t.type){for(;t.parent&&"stage"!=(t=t.parent).type;);if("stage"!==t.type)return!1}return this.stage=t}},{key:"localToGlobal",value:function(t,e){t=t||new z(0,0);var n=this.getConcatenatedMatrix(e);if(null==n)return z(0,0);var i=new X(1,0,0,1,t.x,t.y);return i.concat(n),new z(i.tx,i.ty)}},{key:"globalToLocal",value:function(t,e){if(t=t||new z(0,0),"stage"==this.type)return t;var n=this.getConcatenatedMatrix(e);if(null==n)return new z(0,0);n.invert();var i=new X(1,0,0,1,t.x,t.y);return i.concat(n),new z(i.tx,i.ty)}},{key:"localToTarget",value:function(t,e){var n=localToGlobal(t);return e.globalToLocal(n)}},{key:"getConcatenatedMatrix",value:function(t){for(var e=new X,n=this;null!=n;n=n.parent)if(e.concat(n._transform),!n.parent||t&&n.parent&&n.parent==t||n.parent&&"stage"==n.parent.type)return e;return e}},{key:"setEventEnable",value:function(t){return!!x.isBoolean(t)&&(this._eventEnabled=t,!0)}},{key:"getIndex",value:function(){if(this.parent)return x.indexOf(this.parent.children,this)}},{key:"toBack",value:function(t){if(this.parent){var e=this.getIndex(),n=0;if(x.isNumber(t)){if(0==t)return;n=e-t}var i=this.parent.children.splice(e,1)[0];n<0&&(n=0),this.parent.addChildAt(i,n)}}},{key:"toFront",value:function(t){if(this.parent){var e=this.getIndex(),n=this.parent.children.length,i=n;if(x.isNumber(t)){if(0==t)return;i=e+t+1}var r=this.parent.children.splice(e,1)[0];n<i&&(i=n),this.parent.addChildAt(r,i-1)}}},{key:"_updateTransform",value:function(){var t=new X;t.identity();var e=this.context;if(1!==e.scaleX||1!==e.scaleY){var n=new z(e.scaleOrigin);t.translate(-n.x,-n.y),t.scale(e.scaleX,e.scaleY),t.translate(n.x,n.y)}var i=e.rotation;if(i){n=new z(e.rotateOrigin);t.translate(-n.x,-n.y),t.rotate(i%360*Math.PI/180),t.translate(n.x,n.y)}if(this.xyToInt&&!this.moveing){var r=parseInt(e.x),a=parseInt(e.y);parseInt(e.lineWidth,10)%2==1&&e.strokeStyle&&(r+=.5,a+=.5)}else r=e.x,a=e.y;return 0==r&&0==a||t.translate(r,a),this._transform=t}},{key:"setWorldTransform",value:function(){var t=new X;return t.concat(this._transform),this.parent&&t.concat(this.parent.worldTransform),this.worldTransform=t,this.worldTransform}},{key:"getChildInPoint",value:function(t){var e=!1,n=t.x,i=t.y;if(this.worldTransform){var r=this.worldTransform.clone().invert(),a=[n*gt.RESOLUTION,i*gt.RESOLUTION];n=(a=r.mulVector(a))[0],i=a[1]}if(this.graphics&&(e=this.containsPoint({x:n,y:i})),"text"!=this.type)return e;var s=this.getRect();return!(!s.width||!s.height)&&(e=n>=s.x&&n<=s.x+s.width&&(0<=s.height&&i>=s.y&&i<=s.y+s.height||s.height<0&&i<=s.y&&i>=s.y+s.height))}},{key:"containsPoint",value:function(t){for(var e=!1,n=0;n<this.graphics.graphicsData.length;++n){var i=this.graphics.graphicsData[n];if(i.shape){if(i.hasFill()&&i.shape.contains(t.x,t.y)&&(e=!0))break;if(i.hasLine()&&i.shape.points&&(e=vt(i,t.x,t.y)))break}}return e}},{key:"animate",value:function(t,e,n){if(n=n||this.context){var i=t,r=null;for(var a in i)x.isObject(i[a])?this.animate(i[a],x.extend({},e),n[a]):isNaN(i[a])&&""!==i[a]&&null!==i[a]?(n[a]=i[a],delete i[a]):(r=r||{})[a]=n[a];if(r){(e=e||{}).from=r,e.to=i;var s,o=this,h=function(){};e.onUpdate&&(h=e.onUpdate),e.onUpdate=function(t){if(!n&&s)return st.destroyTween(s),void(s=null);for(var e in t)n[e]=t[e];h.apply(o,[t])};var l=function(){};return e.onComplete&&(l=e.onComplete),e.onComplete=function(t){l.apply(o,arguments),o._removeTween(s)},e.onStop=function(){o._removeTween(s)},e.desc="tweenType:DisplayObject.animate__id:"+this.id+"__objectType:"+this.type,s=st.registTween(e),this._tweens.push(s),s}}}},{key:"_removeTween",value:function(t){for(var e=0;e<this._tweens.length;e++)if(t==this._tweens[e]){this._tweens.splice(e,1);break}}},{key:"removeAnimate",value:function(t){t.stop(),this._removeTween(t)}},{key:"cleanAnimates",value:function(){this._cleanAnimates()}},{key:"_cleanAnimates",value:function(){for(;this._tweens.length;)this._tweens.shift().stop()}},{key:"remove",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"destroy",value:function(){this._destroy()}},{key:"_destroy",value:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}]),i}(),_t=function(){function s(t){var e;return c(this,s),(e=o(this,l(s).call(this,t))).children=[],e.mouseChildren=[],e._eventEnabled=!0,e}return d(s,yt),h(s,[{key:"addChild",value:function(t,e){if(t)return-1!=this.getChildIndex(t)?t.parent=this:(t.parent&&t.parent.removeChild(t),void 0===e&&(e=this.children.length),this.children.splice(e,0,t),(t.parent=this).heartBeat&&this.heartBeat({convertType:"children",target:t,src:this}),this._afterAddChild&&this._afterAddChild(t)),t}},{key:"addChildAt",value:function(t,e){return this.addChild(t,e)}},{key:"removeChild",value:function(t){return this.removeChildAt(x.indexOf(this.children,t))}},{key:"removeChildAt",value:function(t){if(t<0||t>this.children.length-1)return!1;var e=this.children[t];return null!=e&&(e.parent=null),this.children.splice(t,1),this.heartBeat&&this.heartBeat({convertType:"children",target:e,src:this}),this._afterDelChild&&this._afterDelChild(e,t),e}},{key:"removeChildById",value:function(t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].id==t)return this.removeChildAt(e);return!1}},{key:"removeAllChildren",value:function(){for(;0<this.children.length;)this.removeChildAt(0)}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).destroy(),t--,e--;this._destroy()}},{key:"cleanAnimates",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).cleanAnimates();this._cleanAnimates()}},{key:"getChildById",value:function(t,e){if(e)return null;for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].id==t)return this.children[n];return null}},{key:"getChildAt",value:function(t){return t<0||t>this.children.length-1?null:this.children[t]}},{key:"getChildIndex",value:function(t){return x.indexOf(this.children,t)}},{key:"setChildIndex",value:function(t,e){if(t.parent==this){var n=x.indexOf(this.children,t);e!=n&&(this.children.splice(n,1),this.children.splice(e,0,t))}}},{key:"getNumChildren",value:function(){return this.children.length}},{key:"getObjectsUnderPoint",value:function(t,e){for(var n=[],i=this.children.length-1;0<=i;i--){var r=this.children[i];if(null!=r&&r.context.$model.visible)if(r instanceof s){if(!r._eventEnabled)continue;if(r.mouseChildren&&0<r.getNumChildren()){var a=r.getObjectsUnderPoint(t);0<a.length&&(n=n.concat(a))}}else{if(!r._eventEnabled&&!r.dragEnabled)continue;if(r.getChildInPoint(t)&&(n.push(r),null!=e&&!isNaN(e)&&n.length==e))return n}}return n}}]),s}(),mt=function(){function n(t){var e;return c(this,n),t.type="stage",(e=o(this,l(n).call(this,t))).canvas=null,e.ctx=null,e.stageRending=!1,e._isReady=!1,e}return d(n,_t),h(n,[{key:"initStage",value:function(t,e,n){this.canvas=t;var i=this.context;i.width=e,i.height=n,i.scaleX=B._devicePixelRatio,i.scaleY=B._devicePixelRatio,this._isReady=!0}},{key:"heartBeat",value:function(t){this._isReady&&((t=t||{}).stage=this).parent&&this.parent.heartBeat(t)}}]),n}(),wt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:lt,e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;if(c(this,r),this.type=t,this.app=e,n)for(var i in gt.RENDER_OPTIONS)void 0===n[i]&&(n[i]=gt.RENDER_OPTIONS[i]);else n=gt.RENDER_OPTIONS;this.options=n,this.requestAid=null,this._heartBeat=!1,this._preRenderTime=0}return h(r,[{key:"startEnter",value:function(){var t=this;t.requestAid||(t.requestAid=st.registFrame({id:"enterFrame",task:function(){t.enterFrame.apply(t)}}))}},{key:"enterFrame",value:function(){var t=this;t.requestAid=null,B.now=(new Date).getTime(),t._heartBeat&&(this.app.children.length&&t.render(this.app),t._heartBeat=!1,t._preRenderTime=(new Date).getTime())}},{key:"_convertCanvax",value:function(e){x.each(this.app.children,function(t){t.context[e.name]=e.value})}},{key:"heartBeat",value:function(t){var n=this;if(t){if("context"==t.convertType){var e=t.stage,i=t.shape;t.name,t.value,t.preValue;if("canvax"==i.type)n._convertCanvax(t);else if(n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}),i){if(n.app.convertStages[e.id].convertShapes[i.id])return;n.app.convertStages[e.id].convertShapes[i.id]={shape:i,convertType:t.convertType}}}if("children"==t.convertType){var r=t.target;!(e=t.src.getStage())&&"stage"!=r.type||(e=e||r,n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}))}if(!t.convertType){e=t.stage;n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}})}}else x.each(n.app.children,function(t,e){n.app.convertStages[t.id]={stage:t,convertShapes:{}}});n._heartBeat?n._heartBeat=!0:(n._heartBeat=!0,n.startEnter())}}]),r}(),xt=function(){function e(t){c(this,e),this.renderer=t}return h(e,[{key:"render",value:function(t,e,n,i){this.renderer;for(var r=t.graphics.graphicsData,a=e.ctx,s=0;s<r.length;s++){var o=r[s],h=o.shape,l=o.fillStyle,u=o.strokeStyle,c=o.hasFill()&&o.fillAlpha&&!i,f=o.hasLine()&&o.strokeAlpha&&!i;if(a.lineWidth=o.lineWidth,a.shadowColor=o.shadowColor,a.shadowBlur=o.shadowBlur,a.shadowOffsetX=o.shadowOffsetX,a.shadowOffsetY=o.shadowOffsetY,o.type===ct.POLY)a.beginPath(),this.renderPolygon(h.points,h.closed,a,i),c&&(a.globalAlpha=o.fillAlpha*n,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=o.strokeAlpha*n,a.strokeStyle=u,c&&o.shadowBlur&&(a.shadowBlur=0),a.stroke());else if(o.type===ct.RECT)i&&a.rect(h.x,h.y,h.width,h.height),c&&(a.globalAlpha=o.fillAlpha*n,a.fillStyle=l,a.fillRect(h.x,h.y,h.width,h.height)),f&&(a.globalAlpha=o.strokeAlpha*n,a.strokeStyle=u,c&&o.shadowBlur&&(a.shadowBlur=0),a.strokeRect(h.x,h.y,h.width,h.height));else if(o.type===ct.CIRC)a.beginPath(),a.arc(h.x,h.y,h.radius,0,2*Math.PI),a.closePath(),c&&(a.globalAlpha=o.fillAlpha*n,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=o.strokeAlpha*n,a.strokeStyle=u,c&&o.shadowBlur&&(a.shadowBlur=0),a.stroke());else if(o.type===ct.ELIP){var d=2*h.width,p=2*h.height,v=h.x-d/2,g=h.y-p/2;a.beginPath();var y=d/2*.5522848,_=p/2*.5522848,m=v+d,w=g+p,x=v+d/2,b=g+p/2;a.moveTo(v,b),a.bezierCurveTo(v,b-_,x-y,g,x,g),a.bezierCurveTo(x+y,g,m,b-_,m,b),a.bezierCurveTo(m,b+_,x+y,w,x,w),a.bezierCurveTo(x-y,w,v,b+_,v,b),a.closePath(),c&&(a.globalAlpha=o.fillAlpha*n,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=o.strokeAlpha*n,a.strokeStyle=u,c&&o.shadowBlur&&(a.shadowBlur=0),a.stroke())}}}},{key:"renderPolygon",value:function(t,e,n,i){n.moveTo(t[0],t[1]);for(var r=1;r<t.length/2;++r)n.lineTo(t[2*r],t[2*r+1]);(e||i)&&n.closePath()}}]),e}(),bt=function(){function i(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return c(this,i),(e=o(this,l(i).call(this,ut,t,n))).CGR=new xt(s(e)),e}return d(i,wt),h(i,[{key:"render",value:function(t){var e=this;e.app=t,x.each(x.values(t.convertStages),function(t){e.renderStage(t.stage)}),t.convertStages={}}},{key:"renderStage",value:function(t){t.ctx||(t.ctx=t.canvas.getContext("2d")),t.stageRending=!0,t.setWorldTransform(),this._clear(t),this._render(t,t,t.context.globalAlpha),t.stageRending=!1}},{key:"_render",value:function(t,e,n){var i=t.ctx;if(i){var r=e.context.$model;if(e.worldTransform||e.fire("render"),(!e.worldTransform||e._transformChange||e.parent&&e.parent._transformChange)&&(e.setWorldTransform(),e.fire("transform"),e._transformChange=!0),n*=r.globalAlpha,r.visible&&!e.isClip){var a=e.worldTransform.toArray();if(a){i.setTransform.apply(i,a);var s=!1;if(e.clip&&e.clip.graphics){var o=e.clip;i.save(),s=!0,o.worldTransform&&!o._transformChange&&!o.parent._transformChange||(o.setWorldTransform(),o._transformChange=!0),i.setTransform.apply(i,o.worldTransform.toArray()),o.graphics.graphicsData.length||o._draw(o.graphics),this.CGR.render(o,t,n,s),o._transformChange=!1,i.clip()}if(e.graphics&&(e.graphics.graphicsData.length||e._draw(e.graphics),n&&(i.setLineDash([]),r.lineType&&"solid"!=r.lineType&&i.setLineDash(r.lineDash),this.CGR.render(e,t,n))),"text"==e.type&&e.render(i,n),e.children)for(var h=0,l=e.children.length;h<l;h++)this._render(t,e.children[h],n);e._transformChange=!1,s&&i.restore()}}}}},{key:"_clear",value:function(t){var e=t.ctx;e.setTransform.apply(e,t.worldTransform.toArray()),e.clearRect(0,0,this.app.width,this.app.height)}}]),i}();var kt=function(){function a(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};c(this,a),t.type="canvax",(e=o(this,l(a).call(this,t)))._cid=(new Date).getTime()+"_"+Math.floor(100*Math.random()),e.el=R.query(t.el),e.width=parseInt("width"in t||e.el.offsetWidth,10),e.height=parseInt("height"in t||e.el.offsetHeight,10);var i,r=R.createView(e.width,e.height,e._cid);return e.view=r.view,e.stageView=r.stageView,e.domView=r.domView,e.el.innerHTML="",e.el.appendChild(e.view),e.viewOffset=R.offset(e.view),e.lastGetRO=0,e.webGL=t.webGL,e.renderer=(i=s(e),new bt(i,n)),e.event=null,e.convertStages={},e.context.$model.width=e.width,e.context.$model.height=e.height,e._bufferStage=null,e._creatHoverStage(),e.worldTransform=(new X).identity(),e}return d(a,_t),h(a,[{key:"registEvent",value:function(t){return this.event=new Y.Handler(this,t),this.event.init(),this.event}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++){var n=this.children[t];n.destroy(),n.canvas=null,n.ctx=null,n=null,t--,e--}try{this.view.removeChild(this.stageView),this.view.removeChild(this.domView),this.el.removeChild(this.view)}catch(t){}this.el.innerHTML="",this.event=null,this._bufferStage=null}},{key:"resize",value:function(t){this.width=parseInt(t&&"width"in t||this.el.offsetWidth,10),this.height=parseInt(t&&"height"in t||this.el.offsetHeight,10),this.viewOffset=R.offset(this.view),this.context.$model.width=this.width,this.context.$model.height=this.height;var i=this;x.each(this.children,function(t,e){var n;t.context.$model.width=i.width,t.context.$model.height=i.height,(n=t.canvas).style.width=i.width+"px",n.style.height=i.height+"px",n.setAttribute("width",i.width*B._devicePixelRatio),n.setAttribute("height",i.height*B._devicePixelRatio)}),this.stageView.style.width=this.width+"px",this.stageView.style.height=this.height+"px",this.domView.style.width=this.width+"px",this.domView.style.height=this.height+"px",this.heartBeat()}},{key:"getHoverStage",value:function(){return this._bufferStage}},{key:"_creatHoverStage",value:function(){this._bufferStage=new mt({id:"activCanvas"+(new Date).getTime(),context:{width:this.context.$model.width,height:this.context.$model.height}}),this._bufferStage._eventEnabled=!1,this.addChild(this._bufferStage)}},{key:"updateViewOffset",value:function(){var t=(new Date).getTime();1e3<t-this.lastGetRO&&(this.viewOffset=R.offset(this.view),this.lastGetRO=t)}},{key:"_afterAddChild",value:function(t,e){var n;n=t.canvas?t.canvas:R.createCanvas(this.context.$model.width,this.context.$model.height,t.id),1==this.children.length?this.stageView.appendChild(n):1<this.children.length&&(void 0===e?this.stageView.insertBefore(n,this._bufferStage.canvas):e>=this.children.length-1?this.stageView.appendChild(n):this.stageView.insertBefore(n,this.children[e].canvas)),B.initElement(n),t.initStage(n,this.context.$model.width,this.context.$model.height)}},{key:"_afterDelChild",value:function(t){try{this.stageView.removeChild(t.canvas)}catch(t){}}},{key:"heartBeat",value:function(t){0<this.children.length&&this.renderer.heartBeat(t)}},{key:"toDataURL",value:function(){var t=R.createCanvas(this.width,this.height,"curr_base64_canvas"),e=t.getContext("2d");return x.each(this.children,function(t){e.drawImage(t.canvas,0,0)}),t.toDataURL()}}]),a}(),Tt=function(){function e(t){return c(this,e),(t=B.checkOpt(t)).type="sprite",o(this,l(e).call(this,t))}return d(e,_t),e}(),Ct=function(){function u(t,e,n,i,r,a,s,o,h,l){c(this,u),this.lineWidth=t,this.strokeStyle=e,this.strokeAlpha=n,this.fillStyle=i,this.fillAlpha=r,this.shadowOffsetX=a,this.shadowOffsetY=s,this.shadowBlur=o,this.shadowColor=h,this.shape=l,this.type=l.type,this.holes=[],this.fill=!0,this.line=!0}return h(u,[{key:"clone",value:function(){var t=new u(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.shape);return t.fill=this.fill,t.line=this.line,t}},{key:"addHole",value:function(t){this.holes.push(t)}},{key:"synsStyle",value:function(t){this.line&&(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha),this.fill&&(this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha),this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor}},{key:"hasFill",value:function(){return this.fillStyle&&this.fill&&void 0!==this.shape.closed&&this.shape.closed}},{key:"hasLine",value:function(){return this.strokeStyle&&this.lineWidth&&this.line}},{key:"destroy",value:function(){this.shape=null,this.holes=null}}]),u}(),Pt={},At={},St=Array.prototype.join;function Et(t,e,n,i,r,a,s){var o=St.call(arguments);if(Pt[o])return Pt[o];var h=Math.PI,l=s*h/180,u=Math.sin(l),c=Math.cos(l),f=0,d=0,p=-c*t*.5-u*e*.5,v=-c*e*.5+u*t*.5,g=(n=Math.abs(n))*n,y=(i=Math.abs(i))*i,_=v*v,m=p*p,w=g*y-g*_-y*m,x=0;if(w<0){var b=Math.sqrt(1-w/(g*y));n*=b,i*=b}else x=(r===a?-1:1)*Math.sqrt(w/(g*_+y*m));var k=x*n*v/i,T=-x*i*p/n,C=c*k-u*T+.5*t,P=u*k+c*T+.5*e,A=It(1,0,(p-k)/n,(v-T)/i),S=It((p-k)/n,(v-T)/i,(-p-k)/n,(-v-T)/i);0===a&&0<S?S-=2*h:1===a&&S<0&&(S+=2*h);for(var E=Math.ceil(Math.abs(S/h*2)),O=[],I=S/E,M=8/3*Math.sin(I/4)*Math.sin(I/4)/Math.sin(I/2),L=A+I,D=0;D<E;D++)O[D]=Ot(A,L,c,u,n,i,C,P,M,f,d),f=O[D][4],d=O[D][5],A=L,L+=I;return Pt[o]=O}function Ot(t,e,n,i,r,a,s,o,h,l,u){var c=St.call(arguments);if(At[c])return At[c];var f=Math.cos(t),d=Math.sin(t),p=Math.cos(e),v=Math.sin(e),g=n*r*p-i*a*v+s,y=i*r*p+n*a*v+o,_=l+h*(-n*r*d-i*a*f),m=u+h*(-i*r*d+n*a*f),w=g+h*(n*r*v+i*a*p),x=y+h*(i*r*v-n*a*p);return At[c]=[_,m,w,x,g,y],At[c]}function It(t,e,n,i){var r=Math.atan2(e,t),a=Math.atan2(i,n);return r<=a?a-r:2*Math.PI-(r-a)}var Mt=function(t,e,n,i){for(var r=i[0],a=i[1],s=i[2],o=i[3],h=i[4],l=[[],[],[],[]],u=Et(i[5]-e,i[6]-n,r,a,o,h,s),c=0,f=u.length;c<f;c++)l[c][0]=u[c][0]+e,l[c][1]=u[c][1]+n,l[c][2]=u[c][2]+e,l[c][3]=u[c][3]+n,l[c][4]=u[c][4]+e,l[c][5]=u[c][5]+n,t.bezierCurveTo.apply(t,l[c])},Lt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;c(this,r),this.x=t,this.y=e,this.width=n,this.height=i,this.type=ct.RECT,this.closed=!0}return h(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.height*e<0||this.width*t<0)&&(t>=this.x&&t<=this.x+this.width&&(0<=this.height&&e>=this.y&&e<=this.y+this.height||this.height<0&&e<=this.y&&e>=this.y+this.height))}}]),r}(),Dt=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;c(this,i),this.x=t,this.y=e,this.radius=n,this.type=ct.CIRC,this.closed=!0}return h(i,[{key:"clone",value:function(){return new i(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n}},{key:"getBounds",value:function(){return new Lt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),i}(),Rt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;c(this,r),this.x=t,this.y=e,this.width=n,this.height=i,this.type=ct.ELIP,this.closed=!0}return h(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1}},{key:"getBounds",value:function(){return new Lt(this.x-this.width,this.y-this.height,this.width,this.height)}}]),r}(),Bt=function(){function o(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];c(this,o);var i=e[0];if(Array.isArray(i)&&(e=i),i&&"x"in i&&"y"in i){for(var r=[],a=0,s=e.length;a<s;a++)r.push(e[a].x,e[a].y);e=r}this.closed=!0,this.points=e,this.type=ct.POLY}return h(o,[{key:"clone",value:function(){return new o(this.points.slice())}},{key:"close",value:function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1]),this.closed=!0}},{key:"contains",value:function(t,e){return this._isInsidePolygon_WindingNumber(t,e)}},{key:"_isInsidePolygon_WindingNumber",value:function(t,e){for(var n,i=this.points,r=0,a=i[1]>e,s=3;s<i.length;s+=2)if((n=a)!=(a=i[s]>e)){var o=(n?1:0)-(a?1:0);0<o*((i[s-3]-t)*(i[+s]-e)-(i[s-2]-e)*(i[s-1]-t))&&(r+=o)}return r}}]),o}();var Ft=function(){function n(t){c(this,n),this.lineWidth=1,this.strokeStyle=null,this.strokeAlpha=1,this.fillStyle=null,this.fillAlpha=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="black",this.graphicsData=[],this.currentPath=null,this.dirty=0,this.clearDirty=0,this._webGL={},this.worldAlpha=1,this.tint=16777215,this.Bound={x:0,y:0,width:0,height:0}}return h(n,[{key:"setStyle",value:function(t){var e=t.$model;this.lineWidth=e.lineWidth,this.strokeStyle=e.strokeStyle,this.strokeAlpha=e.strokeAlpha*e.globalAlpha,this.fillStyle=e.fillStyle,this.fillAlpha=e.fillAlpha*e.globalAlpha,this.shadowOffsetX=e.shadowOffsetX,this.shadowOffsetY=e.shadowOffsetY,this.shadowBlur=e.shadowBlur,this.shadowColor=e.shadowColor;var n=this;this.graphicsData.length&&x.each(this.graphicsData,function(t,e){t.synsStyle(n)})}},{key:"clone",value:function(){for(var t=new n,e=t.dirty=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t}},{key:"moveTo",value:function(t,e){var n=new Bt([t,e]);return n.closed=!1,this.drawShape(n),this}},{key:"lineTo",value:function(t,e){return this.currentPath?(this.currentPath.shape.points.push(t,e),this.dirty++):this.moveTo(0,0),this}},{key:"quadraticCurveTo",value:function(t,e,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r=this.currentPath.shape.points,a=0,s=0;0===r.length&&this.moveTo(0,0);for(var o=r[r.length-2],h=r[r.length-1],l=1;l<=20;++l){var u=l/20;a=o+(t-o)*u,s=h+(e-h)*u,r.push(a+(t+(n-t)*u-a)*u,s+(e+(i-e)*u-s)*u)}return this.dirty++,this}},{key:"bezierCurveTo",value:function(t,e,n,i,r,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,o=s[s.length-2],h=s[s.length-1];return s.length-=2,function(t,e,n,i,r,a,s,o,h){var l=8<arguments.length&&void 0!==h?h:[],u=0,c=0,f=0,d=0,p=0;l.push(t,e);for(var v=1,g=0;v<=20;++v)f=(c=(u=1-(g=v/20))*u)*u,p=(d=g*g)*g,l.push(f*t+3*c*g*n+3*u*d*r+p*s,f*e+3*c*g*i+3*u*d*a+p*o)}(o,h,t,e,n,i,r,a,s),this.dirty++,this}},{key:"arcTo",value:function(t,e,n,i,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var a=this.currentPath.shape.points,s=a[a.length-2],o=a[a.length-1]-e,h=s-t,l=i-e,u=n-t,c=Math.abs(o*u-h*l);if(c<1e-8||0===r)a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e);else{var f=o*o+h*h,d=l*l+u*u,p=o*l+h*u,v=r*Math.sqrt(f)/c,g=r*Math.sqrt(d)/c,y=v*p/f,_=g*p/d,m=v*u+g*h,w=v*l+g*o,x=h*(g+y),b=o*(g+y),k=u*(v+_),T=l*(v+_),C=Math.atan2(b-w,x-m),P=Math.atan2(T-w,k-m);this.arc(m+t,w+e,r,C,P,u*o<h*l)}return this.dirty++,this}},{key:"arc",value:function(t,e,n,i,r,a){var s=5<arguments.length&&void 0!==a&&a;if(i===r)return this;!s&&r<=i?r+=2*Math.PI:s&&i<=r&&(i+=2*Math.PI);var o=r-i,h=48*Math.ceil(Math.abs(o)/(2*Math.PI));if(0==o)return this;var l=t+Math.cos(i)*n,u=e+Math.sin(i)*n,c=this.currentPath?this.currentPath.shape.points:null;c?c[c.length-2]===l&&c[c.length-1]===u||c.push(l,u):(this.moveTo(l,u),c=this.currentPath.shape.points);for(var f=o/(2*h),d=2*f,p=Math.cos(f),v=Math.sin(f),g=h-1,y=g%1/g,_=0;_<=g;++_){var m=f+i+d*(_+y*_),w=Math.cos(m),x=-Math.sin(m);c.push((p*w+v*x)*n+t,(p*-x+v*w)*n+e)}return this.dirty++,this}},{key:"drawRect",value:function(t,e,n,i){return this.drawShape(new Lt(t,e,n,i)),this}},{key:"drawCircle",value:function(t,e,n){return this.drawShape(new Dt(t,e,n)),this}},{key:"drawEllipse",value:function(t,e,n,i){return this.drawShape(new Rt(t,e,n,i)),this}},{key:"drawPolygon",value:function(t){var e=t,n=!0;if(e instanceof Bt&&(n=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}var r=new Bt(e);return r.closed=n,this.drawShape(r),this}},{key:"clear",value:function(){return 0<this.graphicsData.length&&(this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this}},{key:"drawShape",value:function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.beginPath();var e=new Ct(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,t);return this.graphicsData.push(e),e.type===ct.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e}},{key:"beginPath",value:function(){this.currentPath=null}},{key:"closePath",value:function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this}},{key:"updateLocalBounds",value:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0;if(this.graphicsData.length)for(var r=0,a=0,s=0,o=0,h=0,l=0;l<this.graphicsData.length;l++){var u=this.graphicsData[l],c=u.type,f=u.lineWidth;if(r=u.shape,c===ct.RECT||c===ct.RREC)a=r.x-f/2,s=r.y-f/2,t=a<t?a:t,e=e<a+(o=r.width+f)?a+o:e,n=s<n?s:n,i=i<s+(h=r.height+f)?s+h:i;else if(c===ct.CIRC)a=r.x,s=r.y,t=a-(o=r.radius+f/2)<t?a-o:t,e=e<a+o?a+o:e,n=s-(h=r.radius+f/2)<n?s-h:n,i=i<s+h?s+h:i;else if(c===ct.ELIP)a=r.x,s=r.y,t=a-(o=r.width+f/2)<t?a-o:t,e=e<a+o?a+o:e,n=s-(h=r.height+f/2)<n?s-h:n,i=i<s+h?s+h:i;else for(var d=r.points,p=0,v=0,g=0,y=0,_=0,m=0,w=0,x=0,b=0;b+2<d.length;b+=2)a=d[b],s=d[b+1],p=d[b+2],v=d[b+3],g=Math.abs(p-a),y=Math.abs(v-s),h=f,(o=Math.sqrt(g*g+y*y))<1e-9||(t=(w=(p+a)/2)-(_=(h/o*y+g)/2)<t?w-_:t,e=e<w+_?w+_:e,n=(x=(v+s)/2)-(m=(h/o*g+y)/2)<n?x-m:n,i=i<x+m?x+m:i)}else i=n=e=t=0;return this.Bound={x:t,y:n,width:e-t,height:i-n},this}},{key:"getBound",value:function(){return this.updateLocalBounds().Bound}},{key:"destroy",value:function(){for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webGL)for(var n=0;n<this._webGL[e].data.length;++n)this._webGL[e].data[n].destroy();this.graphicsData=null,this.currentPath=null,this._webGL=null}}]),n}(),$t=function(){function r(t){var e;c(this,r);var n={cursor:(t=B.checkOpt(t)).context.cursor||"default",fillAlpha:t.context.fillAlpha||1,fillStyle:t.context.fillStyle||null,lineCap:t.context.lineCap||"round",lineJoin:t.context.lineJoin||"round",miterLimit:t.context.miterLimit||null,strokeAlpha:t.context.strokeAlpha||1,strokeStyle:t.context.strokeStyle||null,lineType:t.context.lineType||"solid",lineDash:t.context.lineDash||[6,3],lineWidth:t.context.lineWidth||null,shadowOffsetX:t.context.shadowOffsetX||0,shadowOffsetY:t.context.shadowOffsetY||0,shadowBlur:t.context.shadowBlur||0,shadowColor:t.context.shadowColor||"#000000"},i=x.extend(!0,n,t.context);return t.context=i,void 0===t.id&&void 0!==t.type&&(t.id=B.createId(t.type)),(e=o(this,l(r).call(this,t)))._hoverClass=!1,e.hoverClone=!0,e.pointChkPriority=!0,e._eventEnabled=!1,e.dragEnabled=t.dragEnabled||!1,e._dragDuplicate=null,e.type=e.type||"shape",e.initCompProperty(t),e.isClone?e.graphics=null:(e.graphics=new Ft,e._draw(e.graphics)),e}return d(r,yt),h(r,[{key:"_draw",value:function(t){0==t.graphicsData.length&&(t.setStyle(this.context),this.draw(t))}},{key:"draw",value:function(){}},{key:"clearGraphicsData",value:function(){this.graphics.clear()}},{key:"$watch",value:function(t,e,n){-1<x.indexOf(dt,t)&&this.graphics.setStyle(this.context),this.watch(t,e,n)}},{key:"initCompProperty",value:function(t){for(var e in t)"id"!=e&&"context"!=e&&(this[e]=t[e])}},{key:"getBound",value:function(){return this.graphics.updateLocalBounds().Bound}}]),r}(),Nt=function(){function i(t,e){var n;return c(this,i),e.type="text",null==t&&(t=""),e.context=x.extend({font:"",fontSize:13,fontWeight:"normal",fontFamily:"微软雅黑,sans-serif",textBaseline:"top",textAlign:"left",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},e.context),(n=o(this,l(i).call(this,e)))._reNewline=/\r?\n/,n.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],n.context.font=n._getFontDeclaration(),n.text=t.toString(),n.context.width=n.getTextWidth(),n.context.height=n.getTextHeight(),n}return d(i,yt),h(i,[{key:"$watch",value:function(t,e){0<=x.indexOf(this.fontProperts,t)&&(this.context[t]=e,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())}},{key:"_setContextStyle",value:function(t,e,n){for(var i in e)"textBaseline"!=i&&i in t&&(e[i]||x.isNumber(e[i]))&&("globalAlpha"==i?t.globalAlpha=n:t[i]=e[i])}},{key:"render",value:function(t,e){this._renderText(t,this._getTextLines(),e)}},{key:"resetText",value:function(t){this.text=t.toString(),this.heartBeat()}},{key:"getTextWidth",value:function(){var t=0;return B._pixelCtx&&(B._pixelCtx.save(),B._pixelCtx.font=this.context.$model.font,t=this._getTextWidth(B._pixelCtx,this._getTextLines()),B._pixelCtx.restore()),t}},{key:"getTextHeight",value:function(){return this._getTextHeight(B._pixelCtx,this._getTextLines())}},{key:"_getTextLines",value:function(){return this.text.split(this._reNewline)}},{key:"_renderText",value:function(t,e,n){t&&(t.save(),this._setContextStyle(t,this.context.$model,n),this._renderTextStroke(t,e),this._renderTextFill(t,e),t.restore())}},{key:"_getFontDeclaration",value:function(){var n=this,i=[];return x.each(this.fontProperts,function(t){var e=n.context[t];"fontSize"==t&&(e=parseFloat(e)+"px"),e&&i.push(e)}),i.join(" ")}},{key:"_renderTextFill",value:function(t,e){if(this.context.$model.fillStyle){this._boundaries=[];for(var n=0,i=0,r=e.length;i<r;i++){n+=this._getHeightOfLine(t,i,e),this._renderTextLine("fillText",t,e[i],0,this._getTopOffset()+n,i)}}}},{key:"_renderTextStroke",value:function(t,e){if(t&&this.context.$model.strokeStyle&&this.context.$model.lineWidth){var n=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=e.length;i<r;i++){n+=this._getHeightOfLine(t,i,e),this._renderTextLine("strokeText",t,e[i],0,this._getTopOffset()+n,i)}t.closePath(),t.restore()}}},{key:"_renderTextLine",value:function(t,e,n,i,r,a){if(r-=this._getHeightOfLine()/4,"justify"===this.context.$model.textAlign){var s=e.measureText(n).width,o=this.context.$model.width;if(s<o)for(var h=n.split(/\s+/),l=(o-e.measureText(n.replace(/\s+/g,"")).width)/(h.length-1),u=0,c=0,f=h.length;c<f;c++)this._renderChars(t,e,h[c],i+u,r,a),u+=e.measureText(h[c]).width+l;else this._renderChars(t,e,n,i,r,a)}else this._renderChars(t,e,n,i,r,a)}},{key:"_renderChars",value:function(t,e,n,i,r){e[t](n,0,r)}},{key:"_getHeightOfLine",value:function(){return this.context.$model.fontSize*this.context.$model.lineHeight}},{key:"_getTextWidth",value:function(t,e){for(var n=t.measureText(e[0]||"|").width,i=1,r=e.length;i<r;i++){var a=t.measureText(e[i]).width;n<a&&(n=a)}return n}},{key:"_getTextHeight",value:function(t,e){return this.context.$model.fontSize*e.length*this.context.$model.lineHeight}},{key:"_getTopOffset",value:function(){var t=0;switch(this.context.$model.textBaseline){case"top":t=0;break;case"middle":t=-this.context.$model.height/2;break;case"bottom":t=-this.context.$model.height}return t}},{key:"getRect",value:function(){var t=this.context,e=0,n=0;return"center"==t.textAlign&&(e=-t.width/2),"right"==t.textAlign&&(e=-t.width),"middle"==t.textBaseline&&(n=-t.height/2),"bottom"==t.textBaseline&&(n=-t.height),{x:e,y:n,width:t.width,height:t.height}}}]),i}();function jt(t,e){var n=0,i=0;if(1==arguments.length&&x.isObject(t)){var r=t;x.isArray(r)?(n=r[0],i=r[1]):r.hasOwnProperty("x")&&r.hasOwnProperty("y")&&(n=r.x,i=r.y)}this._axes=[n,i]}function Wt(t,e,n,i,r,a,s){var o=.25*(n-t),h=.25*(i-e);return(2*(e-n)+o+h)*s+(-3*(e-n)-2*o-h)*a+o*r+e}jt.prototype={distance:function(t){var e=this._axes[0]-t._axes[0],n=this._axes[1]-t._axes[1];return Math.sqrt(e*e+n*n)}};var Ht={sin:{},cos:{}},Ut=Math.PI/180;function Vt(t,e){var n={points:t};x.isFunction(e)&&(n.smoothFilter=e);var i=function(t){var e=t.points,n=t.isLoop,i=t.smoothFilter,r=e.length;if(1==r)return e;for(var a=[],s=0,o=new jt(e[0]),h=null,l=1;l<r;l++)h=new jt(e[l]),s+=o.distance(h),o=h;h=o=null;var u=s/6;for(u=u<r?r:u,l=0;l<u;l++){var c,f,d,p=l/(u-1)*(n?r:r-1),v=Math.floor(p),g=p-v,y=e[v%r];d=n?(c=e[(v-1+r)%r],f=e[(v+1)%r],e[(v+2)%r]):(c=e[0===v?v:v-1],f=e[r-2<v?r-1:v+1],e[r-3<v?r-1:v+2]);var _=g*g,m=g*_,w=[Wt(c[0],y[0],f[0],d[0],g,_,m),Wt(c[1],y[1],f[1],d[1],g,_,m)];x.isFunction(i)&&i(w),a.push(w)}return a}(n);return t&&0<t.length&&i.push(t[t.length-1]),i}function Xt(t){return!t||x.isArray(t)&&2<=t.length&&(!x.isNumber(t[0])||!x.isNumber(t[1]))||"x"in t&&!x.isNumber(t.x)||"y"in t&&!x.isNumber(t.y)}var Yt={PI:Math.PI,sin:function(t,e){return t=(e?t*Ut:t).toFixed(4),void 0===Ht.sin[t]&&(Ht.sin[t]=Math.sin(t)),Ht.sin[t]},cos:function(t,e){return t=(e?t*Ut:t).toFixed(4),void 0===Ht.cos[t]&&(Ht.cos[t]=Math.cos(t)),Ht.cos[t]},degreeToRadian:function(t){return t*Ut},radianToDegree:function(t){return t/Ut},degreeTo360:function(t){var e=(360+t%360)%360;return 0==e&&0!==t&&(e=360),e},getIsgonPointList:function(t,e){for(var n=[],i=2*Math.PI/t,r=-Math.PI/2,a=0,s=t;a<s;a++)n.push([e*Math.cos(r),e*Math.sin(r)]),r+=i;return n},getSmoothPointList:function(t,n){var i=[],r=t.length,a=[];return x.each(t,function(t,e){Xt(t)?(a.length&&(i=i.concat(Vt(a,n)),a=[]),i.push(t)):a.push(t),e==r-1&&a.length&&(i=i.concat(Vt(a,n)),a=[])}),i},isNotValibPoint:Xt,isValibPoint:function(t){return!Xt(t)}},qt=function(){function i(t){var e;c(this,i),t=B.checkOpt(t);var n=x.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:B.__emptyFunc},t.context);return!t.isClone&&n.smooth&&(n.pointList=Yt.getSmoothPointList(n.pointList,n.smoothFilter)),t.context=n,t.type="brokenline",(e=o(this,l(i).call(this,t)))._pointList=n.pointList,e}return d(i,$t),h(i,[{key:"watch",value:function(t,e){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||("pointList"==t&&this.context.smooth&&(this.context.pointList=Yt.getSmoothPointList(e,this.context.smoothFilter),this._pointList=e),"smooth"==t&&(this.context.pointList=e?Yt.getSmoothPointList(this._pointList,this.context.smoothFilter):this._pointList),this.graphics.clear())}},{key:"draw",value:function(t){for(var e=this.context.pointList,n=!1,i=0,r=e.length;i<r;i++){var a=e[i];n=!!Yt.isValibPoint(a)&&(n?t.lineTo(a[0],a[1]):t.moveTo(a[0],a[1]),!0)}return this}}]),i}(),Gt=function(){function e(t){return c(this,e),t=x.extend(!0,{type:"circle",xyToInt:!1,context:{r:0}},B.checkOpt(t)),o(this,l(e).call(this,t))}return d(e,$t),h(e,[{key:"watch",value:function(t){"r"==t&&this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model.r;e<0&&(e=0),t.drawCircle(0,0,e)}}]),e}(),zt=function(){function n(t){c(this,n);var e=x.extend(!0,{pointList:[],path:""},t.context);return t.context=e,t.__parsePathData=null,t.type="path",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){"path"==t&&this.graphics.clear()}},{key:"_parsePathData",value:function(t){if(this.__parsePathData)return this.__parsePathData;if(!t)return[];this.__parsePathData=[];var e=x.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),n=this;return x.each(e,function(t){n.__parsePathData.push(n._parseChildPathData(t))}),this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e,n=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(n=(n=(n=(n=n.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),e=0;e<i.length;e++)n=n.replace(new RegExp(i[e],"g"),"|"+i[e]);var r=n.split("|"),a=[],s=0,o=0;for(e=1;e<r.length;e++){var h=r[e],l=h.charAt(0),u=(h=(h=h.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");0<u.length&&""===u[0]&&u.shift();for(var c=0;c<u.length;c++)u[c]=parseFloat(u[c]);for(;0<u.length&&!isNaN(u[0]);){var f,d,p,v=null,g=[],y=s,_=o;switch(l){case"l":s+=u.shift(),o+=u.shift(),v="L",g.push(s,o);break;case"L":s=u.shift(),o=u.shift(),g.push(s,o);break;case"m":s+=u.shift(),o+=u.shift(),v="M",g.push(s,o),l="l";break;case"M":s=u.shift(),o=u.shift(),v="M",g.push(s,o),l="L";break;case"h":s+=u.shift(),v="L",g.push(s,o);break;case"H":s=u.shift(),v="L",g.push(s,o);break;case"v":o+=u.shift(),v="L",g.push(s,o);break;case"V":o=u.shift(),v="L",g.push(s,o);break;case"C":g.push(u.shift(),u.shift(),u.shift(),u.shift()),s=u.shift(),o=u.shift(),g.push(s,o);break;case"c":g.push(s+u.shift(),o+u.shift(),s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),v="C",g.push(s,o);break;case"S":f=s,d=o,"C"===(p=a[a.length-1]).command&&(f=s+(s-p.points[2]),d=o+(o-p.points[3])),g.push(f,d,u.shift(),u.shift()),s=u.shift(),o=u.shift(),v="C",g.push(s,o);break;case"s":f=s,d=o,"C"===(p=a[a.length-1]).command&&(f=s+(s-p.points[2]),d=o+(o-p.points[3])),g.push(f,d,s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),v="C",g.push(s,o);break;case"Q":g.push(u.shift(),u.shift()),s=u.shift(),o=u.shift(),g.push(s,o);break;case"q":g.push(s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),v="Q",g.push(s,o);break;case"T":f=s,d=o,"Q"===(p=a[a.length-1]).command&&(f=s+(s-p.points[0]),d=o+(o-p.points[1])),s=u.shift(),o=u.shift(),v="Q",g.push(f,d,s,o);break;case"t":f=s,d=o,"Q"===(p=a[a.length-1]).command&&(f=s+(s-p.points[0]),d=o+(o-p.points[1])),s+=u.shift(),o+=u.shift(),v="Q",g.push(f,d,s,o);break;case"A":y=s,_=o,v="A",g=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),s=u.shift(),o=u.shift(),y,_];break;case"a":y=s,_=o,v="A",g=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),s+=u.shift(),o+=u.shift(),y,_]}a.push({command:v||l,points:g})}"z"!==l&&"Z"!==l||a.push({command:"z",points:[]})}return a}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),n=0,i=e.length;n<i;n++)for(var r=0,a=e[n].length;r<a;r++){var s=e[n][r].command,o=e[n][r].points;switch(s){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":Mt(t,o[7],o[8],o);break;case"z":t.closePath()}}return this}}]),n}(),Qt=function(){function n(t){var e;c(this,n),t=x.extend(!0,{type:"droplet",context:{hr:0,vr:0}},B.checkOpt(t));e=o(this,l(n).call(this,t));return e.context.$model.path=e.createPath(),e}return d(n,zt),h(n,[{key:"watch",value:function(t){"hr"!=t&&"vr"!=t||(this.context.$model.path=this.createPath())}},{key:"createPath",value:function(){var t=this.context.$model,e="M 0 "+t.hr+" C "+t.hr+" "+t.hr+" "+3*t.hr/2+" "+-t.hr/3+" 0 "+-t.vr;return e+=" C "+3*-t.hr/2+" "+-t.hr/3+" "+-t.hr+" "+t.hr+" 0 "+t.hr+"z"}}]),n}(),Zt=function(){function e(t){return c(this,e),t=x.extend(!0,{type:"ellipse",context:{hr:0,vr:0}},B.checkOpt(t)),o(this,l(e).call(this,t))}return d(e,$t),h(e,[{key:"watch",value:function(t){"hr"!=t&&"vr"!=t||this.graphics.clear()}},{key:"draw",value:function(t){t.drawEllipse(0,0,2*this.context.$model.hr,2*this.context.$model.vr)}}]),e}(),Jt=function(){function i(t){c(this,i);var e=x.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:B.__emptyFunc},t.context);if(!t.isClone){e.pointList[0];var n=e.pointList.slice(-1)[0];e.smooth&&(e.pointList.unshift(n),e.pointList=Yt.getSmoothPointList(e.pointList))}return t.context=e,t.type="polygon",o(this,l(i).call(this,t))}return d(i,$t),h(i,[{key:"watch",value:function(t){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.pointList;if(!(e.length<2)){t.moveTo(e[0][0],e[0][1]);for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n][0],e[n][1]);t.closePath()}}}]),i}(),Kt=function(){function n(t){c(this,n);var e=x.extend(!0,{pointList:[],r:0,n:0},t.context);return e.pointList=Yt.getIsgonPointList(e.n,e.r),t.context=e,t.type="isogon",o(this,l(n).call(this,t))}return d(n,Jt),h(n,[{key:"watch",value:function(t){"r"!=t&&"n"!=t||(this.context.$model.pointList=Yt.getIsgonPointList(this.context.$model.n,this.context.$model.r)),"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}}]),n}(),te=function(){function n(t){c(this,n);var e=x.extend(!0,{start:{x:0,y:0},end:{x:0,y:0}},t.context);return t.context=e,t.type="line",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){"x"!=t&&"y"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model;return t.moveTo(e.start.x,e.start.y),t.lineTo(e.end.x,e.end.y),this}}]),n}(),ee=function(){function n(t){c(this,n);var e=x.extend(!0,{width:0,height:0,radius:[]},t.context);return t.context=e,t.type="rect",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){"width"!=t&&"height"!=t&&"radius"!=t||this.graphics.clear()}},{key:"_buildRadiusPath",value:function(t){var e=this.context.$model,n=e.width,i=e.height,r=B.getCssOrderArr(e.radius),a=t,s=1;0<=i&&(s=-1),a.moveTo(parseInt(0+r[0]),parseInt(i)),a.lineTo(parseInt(0+n-r[1]),parseInt(i)),0!==r[1]&&a.quadraticCurveTo(0+n,i,parseInt(0+n),parseInt(i+r[1]*s)),a.lineTo(parseInt(0+n),parseInt(0-r[2]*s)),0!==r[2]&&a.quadraticCurveTo(0+n,0,parseInt(0+n-r[2]),parseInt(0)),a.lineTo(parseInt(0+r[3]),parseInt(0)),0!==r[3]&&a.quadraticCurveTo(0,0,parseInt(0),parseInt(0-r[3]*s)),a.lineTo(parseInt(0),parseInt(0+i+r[0]*s)),0!==r[0]&&a.quadraticCurveTo(0,0+i,parseInt(0+r[0]),parseInt(0+i))}},{key:"draw",value:function(t){var e=this.context.$model;e.radius.length?this._buildRadiusPath(t):t.drawRect(0,0,e.width,e.height),t.closePath()}}]),n}(),ne=function(){function n(t){c(this,n);var e=x.extend(!0,{pointList:[],r0:0,r:0,startAngle:0,endAngle:0,clockwise:!1},t.context);return t.context=e,t.regAngle=[],t.isRing=!1,t.type="sector",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){"r0"!=t&&"r"!=t&&"startAngle"!=t&&"endAngle"!=t&&"clockwise"!=t||(this.isRing=!1,this.graphics.clear())}},{key:"draw",value:function(t){var e=this.context.$model,n=void 0===e.r0?0:e.r0,i=e.r,r=Yt.degreeTo360(e.startAngle),a=Yt.degreeTo360(e.endAngle);e.startAngle!=e.endAngle&&Math.abs(e.startAngle-e.endAngle)%360==0&&(this.isRing=!0,r=0,a=360),r=Yt.degreeToRadian(r),a=Yt.degreeToRadian(a);var s=t;this.isRing?0==e.r0?s.drawCircle(0,0,e.r):(e.fillStyle&&e.fillAlpha&&(s.beginPath(),s.arc(0,0,i,r,a,e.clockwise),0==e.r0?s.lineTo(0,0):s.arc(0,0,n,a,r,!e.clockwise),s.closePath(),s.currentPath.lineWidth=0,s.currentPath.strokeStyle=null,s.currentPath.strokeAlpha=0,s.currentPath.line=!1),e.lineWidth&&e.strokeStyle&&e.strokeAlpha&&(s.beginPath(),s.arc(0,0,i,r,a,e.clockwise),s.closePath(),s.currentPath.fillStyle=null,s.currentPath.fill=!1,s.beginPath(),s.arc(0,0,n,a,r,!e.clockwise),s.closePath(),s.currentPath.fillStyle=null,s.currentPath.fill=!1)):(s.beginPath(),s.arc(0,0,i,r,a,e.clockwise),0==e.r0?s.lineTo(0,0):s.arc(0,0,n,a,r,!e.clockwise),s.closePath())}}]),n}(),ie=function(){function n(t){c(this,n);var e=x.extend(!0,{control:{x:0,y:0},point:{x:0,y:0},angle:null,theta:30,headlen:6,lineWidth:1,strokeStyle:"#666",fillStyle:null},t.context);return t.context=e,t.type="arrow",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){"x"!=t&&"y"!=t&&"theta"!=t&&"headlen"!=t&&"angle"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.control.x,i=e.control.y,r=e.point.x,a=e.point.y,s=null!=e.angle?e.angle-180:180*Math.atan2(i-a,n-r)/Math.PI,o=(s+e.theta)*Math.PI/180,h=(s-e.theta)*Math.PI/180,l=e.headlen*Math.cos(o),u=e.headlen*Math.sin(o),c=e.headlen*Math.cos(h),f=e.headlen*Math.sin(h),d=r+l,p=a+u;return t.moveTo(d,p),t.lineTo(r,a),t.lineTo(r+c,a+f),e.fillStyle&&(t.lineTo(d,p),t.closePath()),this}}]),n}(),re=function(){function n(t){c(this,n);var e=x.extend(!0,{innerRect:{width:0,height:0},includedAngle:60},t.context);return t.context=e,t.type="diamond",o(this,l(n).call(this,t))}return d(n,$t),h(n,[{key:"watch",value:function(t){-1<["includedAngle"].indexOf(t)&&this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.innerRect,i=e.includedAngle/2*Math.PI/180,r=n.height/Math.tan(i),a=n.width*Math.tan(i),s=n.width+r,o=n.height+a;return t.moveTo(0,o/2),t.lineTo(s/2,0),t.lineTo(0,-o/2),t.lineTo(-s/2,0),t.lineTo(0,o/2),t.closePath(),this}}]),n}(),ae={version:"2.0.69",_:x,$:R,event:Y,App:kt};return ae.Display={DisplayObject:yt,DisplayObjectContainer:_t,Stage:mt,Sprite:Tt,Shape:$t,Point:z,Text:Nt},ae.Shapes={BrokenLine:qt,Circle:Gt,Droplet:Qt,Ellipse:Zt,Isogon:Kt,Line:te,Path:zt,Polygon:Jt,Rect:ee,Sector:ne,Arrow:ie,Diamond:re},ae.AnimationFrame=st,ae.utils=B,ae}();