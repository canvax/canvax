var canvax=function(){"use strict";var c=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var u=t(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}e.exports=n});var a=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var o=function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?a(t):e},l=t(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n}),n=t(function(n){function i(t,e){return n.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}n.exports=i});function f(t){return"number"==typeof(t=E(t))&&0<=t&&t<=O}var e,d=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)},_={},s={},r=Array.prototype,p=Object.prototype,v=r.push,g=r.slice,y=r.concat,m=p.toString,w=p.hasOwnProperty,x=r.forEach,b=r.map,k=r.filter,T=r.every,C=r.some,A=r.indexOf,P=Array.isArray,S=Object.keys,O=Math.pow(2,53)-1,E=(e="length",function(t){return null==t?void 0:t[e]});_.values=function(t){for(var e=_.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},_.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e,n=[];for(e in t)_.has(t,e)&&n.push(e);return n},_.has=function(t,e){return w.call(t,e)};var I=_.each=_.forEach=function(t,e,n){if(null!=t)if(x&&t.forEach===x)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t)===s)return}else for(var a=_.keys(t),i=0,r=a.length;i<r;i++)if(e.call(n,t[a[i]],a[i],t)===s)return};_.compact=function(t){return _.filter(t,_.identity)},_.filter=_.select=function(t,i,r){var a=[];return null==t?a:k&&t.filter===k?t.filter(i,r):(I(t,function(t,e,n){i.call(r,t,e,n)&&a.push(t)}),a)},I(["Arguments","Function","String","Number","Date","RegExp"],function(e){_["is"+e]=function(t){return m.call(t)=="[object "+e+"]"}}),_.isArguments=function(t){return!(!t||!_.has(t,"callee"))},"function"!=typeof/./&&(_.isFunction=function(t){return"function"==typeof t}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!=+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==m.call(t)},_.isNull=function(t){return null===t},_.isEmpty=function(t){if(null==t)return!0;if(_.isArray(t)||_.isString(t))return 0===t.length;for(var e in t)if(_.has(t,e))return!1;return!0},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=P||function(t){return"[object Array]"==m.call(t)},_.isObject=function(t){return t===Object(t)},_.identity=function(t){return t},_.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return t[i=_.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,r+n):n}if(A&&t.indexOf===A)return t.indexOf(e,n);for(;i<r;i++)if(t[i]===e)return i;return-1},_.isWindow=function(t){return null!=t&&t==t.window};function M(t,e,n){return e&&_.every(t,_.isArray)?y.apply(n,t):(I(t,function(t){_.isArray(t)||_.isArguments(t)?e?v.apply(n,t):M(t,e,n):n.push(t)}),n)}_.flatten=function(t,e){return M(t,e,[])},_.every=_.all=function(t,i,r){i=i||_.identity;var a=!0;return null==t?a:T&&t.every===T?t.every(i,r):(I(t,function(t,e,n){if(!(a=a&&i.call(r,t,e,n)))return s}),!!a)},_.min=function(t,i,r){if(!i&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!i&&_.isEmpty(t))return 1/0;var a={computed:1/0,value:1/0};return I(t,function(t,e,n){n=i?i.call(r,t,e,n):t;n<a.computed&&(a={value:t,computed:n})}),a.value},_.max=function(t,i,r){if(!i&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!i&&_.isEmpty(t))return-1/0;var a={computed:-1/0,value:-1/0};return I(t,function(t,e,n){n=i?i.call(r,t,e,n):t;n>a.computed&&(a={value:t,computed:n})}),a.value},_.find=_.detect=function(t,i,r){var a;return L(t,function(t,e,n){if(i.call(r,t,e,n))return a=t,!0}),a};var L=_.some=_.any=function(t,i,r){i=i||_.identity;var a=!1;return null==t?a:C&&t.some===C?t.some(i,r):(I(t,function(t,e,n){if(a=a||i.call(r,t,e,n))return s}),!!a)};_.without=function(t){return _.difference(t,g.call(arguments,1))},_.difference=function(t){var e=y.apply(r,g.call(arguments,1));return _.filter(t,function(t){return!_.contains(e,t)})},_.uniq=_.unique=function(n,i,t,e){_.isFunction(i)&&(e=t,t=i,i=!1);var e=t?_.map(n,t,e):n,r=[],a=[];return I(e,function(t,e){(i?e&&a[a.length-1]===t:_.contains(a,t))||(a.push(t),r.push(n[e]))}),r},_.map=_.collect=function(t,i,r){var a=[];return null==t?a:b&&t.map===b?t.map(i,r):(I(t,function(t,e,n){a.push(i.call(r,t,e,n))}),a)},_.contains=_.include=function(t,e){return null!=t&&(A&&t.indexOf===A?-1!=t.indexOf(e):L(t,function(t){return t===e}))},_.pluck=function(t,e){return _.map(t,function(t){return t[e]})},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.shuffle=function(t){return _.sample(t,1/0)},_.sample=function(t,e,n){if(null==e||n)return(t=!f(t)?_.values(t):t)[_.random(t.length-1)];var i=f(t)?_.clone(t):_.values(t),t=E(i);e=Math.max(Math.min(e,t),0);for(var r=t-1,a=0;a<e;a++){var s=_.random(a,r),o=i[a];i[a]=i[s],i[s]=o}return i.slice(0,e)},_.extend=function(){var t,e,n,i,r=arguments[0]||{},a=1,s=arguments.length,o=!1;for("boolean"==typeof r&&(o=r,r=arguments[1]||{},a=2),"object"===u(r)||_.isFunction(r)||(r={}),s===a&&(r=this,--a);a<s;a++)if(null!=(t=arguments[a]))for(e in t)n=r[e],r!==(i=t[e])&&void 0!==i&&(o&&i&&_.isObject(i)&&i.constructor===Object?r[e]=_.extend(o,n,i):r[e]=i);return r},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend(!0,{},t):t},_.euclideanModulo=function(t,e){return(t%e+e)%e},_.DEG2RAD=Math.PI/180,_.RAD2DEG=180/Math.PI,_.degToRad=function(t){return t*_.DEG2RAD},_.radToDeg=function(t){return t*_.RAD2DEG};var D="undefined"!=typeof window?window.devicePixelRatio:1,R=function(a,s){return document[a]?function t(e,n,i){if(e.length)for(var r=0;r<e.length;r++)t(e[r],n,i);else e[a](n,i,!1)}:function t(e,n,i){if(e.length)for(var r=0;r<e.length;r++)t(e[r],n,i);else e[s]("on"+n,function(){return i.call(e,window.event)})}},B={query:function(t){return _.isString(t)?document.getElementById(t):1==t.nodeType?t:t.length?t[0]:null},offset:function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,r=n.documentElement,a=r.clientTop||i.clientTop||0,s=r.clientLeft||i.clientLeft||0,t=1;return 1<(t=i.getBoundingClientRect?((n=i.getBoundingClientRect()).right-n.left)/i.clientWidth:t)&&(s=a=0),{top:e.top/t+(window.pageYOffset||r&&r.scrollTop/t||i.scrollTop/t)-a,left:e.left/t+(window.pageXOffset||r&&r.scrollLeft/t||i.scrollLeft/t)-s}},addEvent:R("addEventListener","attachEvent"),removeEvent:R("removeEventListener","detachEvent"),pageX:function(t){return t.pageX||(t.clientX?t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft):null)},pageY:function(t){return t.pageY||(t.clientY?t.clientY+(document.documentElement.scrollTop||document.body.scrollTop):null)},createCanvas:function(t,e,n){var i=document.createElement("canvas");return i.style.position="absolute",i.style.width=t+"px",i.style.height=e+"px",i.style.left=0,i.style.top=0,i.setAttribute("width",t*D),i.setAttribute("height",e*D),i.setAttribute("id",n),i},createView:function(t,e,n){var i=document.createElement("div");i.className="canvax-view",i.style.cssText+="position:relative;width:100%;height:100%;";var r=document.createElement("div");r.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;";var a=document.createElement("div");return a.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;",i.appendChild(r),i.appendChild(a),{view:i,stageView:r,domView:a}}},F={mainFrameRate:60,now:0,_pixelCtx:null,__emptyFunc:function(){},_devicePixelRatio:"undefined"!=typeof window?window.devicePixelRatio:1,_UID:0,getUID:function(){return this._UID++},createId:function(t){var e=t.charCodeAt(t.length-1);return 48<=e&&e<=57&&(t+="_"),t+F.getUID()},canvasSupport:function(){return!!document.createElement("canvas").getContext},initElement:function(t){return window.FlashCanvas&&FlashCanvas.initElement&&FlashCanvas.initElement(t),t},getCssOrderArr:function(t){var e,n,i,r;return"number"==typeof t?e=n=i=r=t:t instanceof Array?1===t.length?e=n=i=r=t[0]:2===t.length?(e=i=t[0],n=r=t[1]):3===t.length?(e=t[0],n=r=t[1],i=t[2]):(e=t[0],n=t[1],i=t[2],r=t[3]):e=n=i=r=0,[e,n,i,r]},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),e=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!e||!e.getContextAttributes().stencil)}catch(t){return!1}},checkOpt:function(t){return t?t.context||(t.context={}):t={context:{}},t}};F._pixelCtx=F.initElement(B.createCanvas(1,1,"_pixelCanvas")).getContext("2d");function $(t){var e="CanvaxEvent";_.isString(t)&&(e=t),_.isObject(t)&&t.type&&(e=t.type,_.extend(this,t)),this.target=null,this.currentTarget=null,this.type=e,this.point=null;var n=this;this._stopPropagation=!1,this.stopPropagation=function(){n._stopPropagation=!0,_.isObject(t)&&(t._stopPropagation=!0)},this._preventDefault=!1,this.preventDefault=function(){n._preventDefault=!0,_.isObject(t)&&(t._preventDefault=!0)}}function N(){this._eventMap={}}var j="mousedown mouseup mouseover mousemove mouseout click dblclick wheel keydown keypress keyup",W={_types:j.split(/,| /),register:function(t){t&&(_.isString(t)&&(t=t.split(/,| /)),this._types=j.split(/,| /).concat(t))},get:function(){return this._types}};N.prototype={_setEventEnable:function(){if(!this.children){var t,e=!1;for(t in this._eventMap)-1<_.indexOf(W.get(),t)&&(e=!0);this._eventEnabled=e}},_addEventListener:function(t,n){if("function"!=typeof n)return!1;var i=!0,r=this,e=t;return _.isString(t)&&(e=t.split(/,| /)),_.each(e,function(t){var e=r._eventMap[t];return e?-1==_.indexOf(e,n)?(e.push(n),r._setEventEnable(),!0):void(i=!1):((e=r._eventMap[t]=[]).push(n),r._setEventEnable(),!0)}),i},_removeEventListener:function(t,e){if(1==arguments.length)return this.removeEventListenerByType(t);var n=this._eventMap[t];if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===e)return n.splice(i,1),0==n.length&&(delete this._eventMap[t],this._setEventEnable()),!0;return!1},_removeEventListenerByType:function(t){return!this._eventMap[t]&&(delete this._eventMap[t],this._setEventEnable(),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(t){if(e=this._eventMap[t.type]){t.target||(t.target=this),t.currentTarget||(t.currentTarget=this);for(var e=e.slice(),n=0;n<e.length;n++){var i=e[n];"function"==typeof i&&i.call(this,t)}}return t._stopPropagation||this.parent&&(t.currentTarget=this.parent,this.parent._dispatchEvent(t)),!0},_hasEventListener:function(t){t=this._eventMap[t];return null!=t&&0<t.length}};var U=function(){function t(){return c(this,t),o(this,l(t).call(this))}return d(t,N),h(t,[{key:"on",value:function(t,e){return this._addEventListener(t,e),this}},{key:"addEventListener",value:function(t,e){return this._addEventListener(t,e),this}},{key:"un",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListener",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListenerByType",value:function(t){return this._removeEventListenerByType(t),this}},{key:"removeAllEventListeners",value:function(){return this._removeAllEventListeners(),this}},{key:"fire",value:function(t,e){var n=new $(t);if(e)for(var i in e)"type"!=i&&(n[i]=e[i]);var r=this;return _.each(t.split(" "),function(t){(n.currentTarget=r).dispatchEvent(n)}),this}},{key:"dispatchEvent",value:function(t){if(!this.children||!t.point){if(this.context&&"mouseover"==t.type){var e=this._heartBeatNum,n=this.context.$model.globalAlpha;return this._dispatchEvent(t),void(e!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone&&(i=this.getStage().parent,(e=this.clone(!0))._transform=this.getConcatenatedMatrix(),i._bufferStage.addChildAt(e,0),this._globalAlpha=n,this.context.globalAlpha=0)))}return this._dispatchEvent(t),this.context&&"mouseout"==t.type&&this._hoverClass&&this.hoverClone&&(i=this.getStage().parent,this._hoverClass=!1,i._bufferStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)),this}var i=this.getObjectsUnderPoint(t.point,1)[0];i&&i.dispatchEvent(t)}},{key:"hasEvent",value:function(t){return this._hasEventListener(t)}},{key:"hasEventListener",value:function(t){return this._hasEventListener(t)}},{key:"hover",value:function(t,e){return this.on("mouseover",t),this.on("mouseout",e),this}},{key:"once",value:function(t,e){function n(){e.apply(i,arguments),this.un(t,n)}var i=this;return this.on(t,n),this}}]),t}(),H=["pan","panstart","panmove","panend","pancancel","panleft","panright","panup","pandown","press","pressup","swipe","swipeleft","swiperight","swipeup","swipedown","tap"],V=function(t,e){this.canvax=t,this.curPoints=[{x:0,y:0}],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default",this.target=this.canvax.view,this.drag={start:"panstart",move:"panmove",end:"panend"},_.extend(!0,this,e)},X=document&&document.compareDocumentPosition?function(t,e){return!!e&&!!(16&t.compareDocumentPosition(e))}:function(t,e){return!!e&&(e!=e&&(!t.contains||t.contains(e)))};V.prototype={init:function(){var e=this;null==e.target.nodeType&&W.register(H),B.addEvent(e.target,"contextmenu",function(t){t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1}),_.each(W.get(),function(t){1==e.target.nodeType?B.addEvent(e.target,t,function(t){e.__mouseHandler(t)}):e.target.on(t,function(t){e.__libHandler(t)})})},__mouseHandler:function(t){var e=this,n=e.canvax;n.updateViewOffset(),e.curPoints=[{x:B.pageX(t)-n.viewOffset.left,y:B.pageY(t)-n.viewOffset.top}];var i,r=e.curPoints[0],a=e.curPointsTarget[0];-1<_.indexOf(["mousedown","mouseover","click"],t.type)&&!a&&(a||(i=n.getObjectsUnderPoint(r,1)[0])&&(e.curPointsTarget=[i]),a=e.curPointsTarget[0]),"mousedown"==t.type&&a&&a.dragEnabled&&(e._touching=!0),"mouseup"!=t.type&&("mouseout"!=t.type||X(n.view,t.toElement||t.relatedTarget))||(1==e._draging&&(e._dragEnd(t,a,0),a.fire("dragend")),e._draging=!1,e._touching=!1),"mouseout"==t.type?X(n.view,t.toElement||t.relatedTarget)||e.__getcurPointsTarget(t,r,!0):"mousemove"==t.type?e._touching&&"mousemove"==t.type&&a?(e._draging?e._dragIngHander(t,a,0):(a.fire("dragstart"),a._globalAlpha||(a._globalAlpha=a.context.$model.globalAlpha),a.context.globalAlpha=0,e._clone2hoverStage(a,0).context.globalAlpha=a._globalAlpha),e._draging=!0):e.__getcurPointsTarget(t,r):(a=(a=a)||n,e.__dispatchEventInChilds(t,[a]),e._cursorHander(a)),(n.preventDefault||t._preventDefault)&&(t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1)},__getcurPointsTarget:function(t,e,n){var i=this,r=i.canvax,a=i.curPointsTarget[0];if(a&&!a.context&&(a=null),"mousemove"==(t=new $(t)).type&&a&&a._hoverClass&&a.hoverClone&&a.pointChkPriority&&a.getChildInPoint(e))return t.target=t.currentTarget=a,t.point=a.globalToLocal(e),void a.dispatchEvent(t);r=n?null:r.getObjectsUnderPoint(e,1)[0];(a&&a!=r||"mouseout"==t.type)&&a&&a.context&&(i.curPointsTarget[0]=null,t.type="mouseout",t.toTarget=r,t.target=t.currentTarget=a,t.point=a.globalToLocal(e),a.dispatchEvent(t)),r&&a!=r&&(i.curPointsTarget[0]=r,t.type="mouseover",t.fromTarget=a,t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)),"mousemove"==t.type&&r&&(t.target=t.currentTarget=a,t.point=a.globalToLocal(e),a.dispatchEvent(t)),i._cursorHander(r,a)},_cursorHander:function(t,e){t||e||this._setCursor("default"),t&&e!=t&&t.context&&this._setCursor(t.context.$model.cursor)},_setCursor:function(t){this._cursor!=t&&(this.canvax.view.style.cursor=t,this._cursor=t)},__libHandler:function(n){var i=this,t=i.canvax;t.updateViewOffset(),i.curPoints=i.__getCanvaxPointInTouchs(n),i._draging||(i.curPointsTarget=i.__getChildInTouchs(i.curPoints)),0<i.curPointsTarget.length?(n.type==i.drag.start&&_.each(i.curPointsTarget,function(t,e){if(t&&t.dragEnabled)return i._draging=!0,t._globalAlpha||(t._globalAlpha=t.context.$model.globalAlpha),i._clone2hoverStage(t,e),t.context.globalAlpha=0,t.fire("dragstart"),!1}),n.type==i.drag.move&&i._draging&&_.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&i._dragIngHander(n,t,e)}),n.type==i.drag.end&&i._draging&&(_.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&(i._dragEnd(n,t,0),t.fire("dragend"))}),i._draging=!1),i.__dispatchEventInChilds(n,i.curPointsTarget)):i.__dispatchEventInChilds(n,[t])},__getCanvaxPointInTouchs:function(t){var e=this.canvax,n=[];return _.each(t.point,function(t){n.push({x:B.pageX(t)-e.viewOffset.left,y:B.pageY(t)-e.viewOffset.top})}),n},__getChildInTouchs:function(t){var e=this.canvax,n=[];return _.each(t,function(t){n.push(e.getObjectsUnderPoint(t,1)[0])}),n},__dispatchEventInChilds:function(i,t){if(!(t||"length"in t))return!1;var r=this;_.each(t,function(t,e){var n;t&&((n=new $(i)).stagePoint=r.curPoints[e],n.point=t.globalToLocal(n.stagePoint),t.dispatchEvent(n))})},_clone2hoverStage:function(t,e){var n=this.canvax,i=n._bufferStage.getChildById(t.id);return i||((i=t.clone(!0))._transform=t.getConcatenatedMatrix(),n._bufferStage.addChildAt(i,0)),i.context.globalAlpha=t._globalAlpha,t._dragPoint=t.globalToLocal(this.curPoints[e]),i},_dragIngHander:function(t,e,n){var i=this.canvax,r=e.globalToLocal(this.curPoints[n]);e._noHeart=!0;n=e.moveing;e.moveing=!0,e.context.x+=r.x-e._dragPoint.x,e.context.y+=r.y-e._dragPoint.y,e.fire("draging"),e.moveing=n,e._noHeart=!1;i=i._bufferStage.getChildById(e.id);i._transform=e.getConcatenatedMatrix(),i.worldTransform=null,i.heartBeat()},_dragEnd:function(t,e,n){var i=this.canvax._bufferStage.getChildById(e.id);i&&i.destroy(),e.context.globalAlpha=e._globalAlpha}};var q={Event:$,Dispatcher:U,Handler:V,Manager:N,types:W},G=function(t,e,n,i,r,a){this.a=null!=t?t:1,this.b=null!=e?e:0,this.c=null!=n?n:0,this.d=null!=i?i:1,this.tx=null!=r?r:0,this.ty=null!=a?a:0,this.array=null};G.prototype={concat:function(t){var e=this.a,n=this.c,i=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d,this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},concatTransform:function(t,e,n,i,r){var a=1,s=0;return r%360&&(r=r*Math.PI/180,a=Math.cos(r),s=Math.sin(r)),this.concat(new G(a*n,s*n,-s*i,a*i,t,e)),this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,a=this.tx;return 0<t?(this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e):(e=Math.sin(Math.abs(t)),t=Math.cos(Math.abs(t)),this.a=i*t+this.b*e,this.b=-i*e+this.b*t,this.c=r*t+this.d*e,this.d=-r*e+t*this.d,this.tx=t*a+e*this.ty,this.ty=t*this.ty-e*a),this},scale:function(t,e){return this.a*=t,this.d*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,a=t*i-e*n;return this.a=i/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-i*r)/a,this.ty=-(t*this.ty-e*r)/a,this},clone:function(){return new G(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(t,e){if(0==arguments.length)return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)?null:[this.a,this.b,this.c,this.d,this.tx,this.ty];this.array||(this.array=new Float32Array(9));e=e||this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},mulVector:function(t){var e=this.a,n=this.c,i=this.tx,r=this.b,a=this.d,s=this.ty,o=[0,0];return o[0]=t[0]*e+t[1]*n+i,o[1]=t[0]*r+t[1]*a+s,o}};var Y=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(c(this,a),1==arguments.length&&"object"==u(arguments[0])){var n=arguments[0];if("x"in n&&"y"in n)this.x=+n.x,this.y=+n.y;else{var i,r=0;for(i in n){if(0!=r){this.y=+n[i];break}this.x=+n[i],r++}}}else this.x=+t,this.y=+e}return h(a,[{key:"toArray",value:function(){return[this.x,this.y]}}]),a}(),z=t(function(t,e){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(t=void 0!==t?t:o.now();0<n.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var r=this._tweens[n[i]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[n[i]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i,o=new n;o.Group=n,o._nextId=0,o.nextId=function(){return o._nextId++},"undefined"==typeof window&&"undefined"!=typeof process?o.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?o.now=window.performance.now.bind(window.performance):void 0!==Date.now?o.now=Date.now:o.now=function(){return(new Date).getTime()},o.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=o.Easing.Linear.None,this._interpolationFunction=o.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||o,this._id=o.nextId()},o.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=t,void 0!==e&&(this._duration=e),this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?o.now()+parseFloat(t):t:o.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,n,i,r,a,s;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration,n=0===this._duration||1<n?1:n,i=this._easingFunction(n),this._valuesEnd)void 0!==this._valuesStart[e]&&(r=this._valuesStart[e]||0,(a=this._valuesEnd[e])instanceof Array?this._object[e]=this._interpolationFunction(a,i):"number"==typeof(a="string"==typeof a?"+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a):a)&&(this._object[e]=r+(a-r)*i));if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==n)return!0;if(0<this._repeat){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)"string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo&&(s=this._valuesStartRepeat[e],this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=s),this._valuesStart[e]=this._valuesStartRepeat[e];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,h=this._chainedTweens.length;o<h;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}},o.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-o.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*o.Easing.Bounce.In(2*t):.5*o.Easing.Bounce.Out(2*t-1)+.5}}},o.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),a=o.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],i):1<e?a(t[n],t[n-1],n-i):a(t[r],t[n<r+1?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,a=o.Interpolation.Utils.Bernstein,s=0;s<=i;s++)n+=r(1-e,i-s)*r(e,s)*t[s]*a(i,s);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),a=o.Interpolation.Utils.CatmullRom;return t[0]===t[n]?a(t[((r=e<0?Math.floor(i=n*(1+e)):r)-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):1<e?t[n]-(a(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):a(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=o.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(i=[1],function(t){var e=1;if(i[t])return i[t];for(var n=t;1<n;n--)e*=n;return i[t]=e}),CatmullRom:function(t,e,n,i,r){var a=.5*(n-t),t=.5*(i-e),i=r*r;return(2*e-2*n+a+t)*(r*i)+(-3*e+3*n-2*a-t)*i+a*r+e}}},t.exports=o}),Q=0,K=!0;if("undefined"!=typeof window)for(var Z=window.requestAnimationFrame,J=window.cancelAnimationFrame,tt=["ms","moz","webkit","o"],et=0;et<tt.length&&!window.requestAnimationFrame;++et)Z=window.requestAnimationFrame=window[tt[et]+"RequestAnimationFrame"],J=window.cancelAnimationFrame=window[tt[et]+"CancelAnimationFrame"]||window[tt[et]+"CancelRequestAnimationFrame"];Z=Z||function(t,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-Q)),r=setTimeout(function(){t(n+i)},i);return Q=n+i,r},J=J||function(t){clearTimeout(t)};var nt=[],it=null;function rt(t){if(t)return nt.push(t),it=it||Z(function(){z.update();var t=nt;for(nt=[],it=null;0<t.length;)t.shift().task()})}function at(t){for(var e=!1,n=0,i=nt.length;n<i;n++)nt[n].id===t.id&&(e=!0,nt.splice(n,1),n--,i--);return 0==nt.length&&(J(it),it=null),e}function st(){return K}var ot={setAnimationEnabled:function(t){K=t},getAnimationEnabled:st,registFrame:rt,destroyFrame:at,registTween:function(t){var e=_.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},t);K||(e.duration=0,e.delay=0);var n={},i="tween_"+F.getUID();return e.id&&(i=i+"_"+e.id),e.from&&e.to&&(t=function t(){n._isCompleteed||n._isStoped?n=null:rt({id:i,task:t,desc:e.desc,tween:n})},(n=new z.Tween(e.from).to(e.to,e.duration).onStart(function(){e.onStart(e.from)}).onUpdate(function(){e.onUpdate(e.from)}).onComplete(function(){at({id:i}),n._isCompleteed=!0,e.onComplete(e.from)}).onStop(function(){at({id:i}),n._isStoped=!0,e.onStop(e.from)}).repeat(e.repeat).delay(e.delay).easing(z.Easing[e.easing.split(".")[0]][e.easing.split(".")[1]])).id=i,n.start(),t()),n},destroyTween:function(t,e){t.stop()},Tween:z,taskList:nt};function ht(e){var t,o=!0,h={},n={},i=["$watch","$model"],l={},r=i;for(t in e)!function(a,t){-1===_.indexOf(i,a)&&(l[a]=t);var s=u(t);-1<_.indexOf(r,a)||("function"===s?r.push(a):(t=function(t){var e,n=l[a],i=n;if(!arguments.length)return!n||"object"!==s||n instanceof Array||n.$model||n.addColorStop||((n=ht(n)).$watch=h.$watch,l[a]=n),n;var r=u(t);o||n!==t&&(!t||"object"!==r||t instanceof Array||t.addColorStop?n=t:e=(n=t.$model?t:ht(t)).$model,l[a]=e||n,s!=r&&(s=r),h.$watch&&h.$watch.call(h,a,n,i))},n[a]={set:t,get:t,enumerable:!0}))}(t,e[t]);return h=ut(h,n,r),_.forEach(r,function(t){e[t]&&("function"==typeof e[t]?h[t]=function(){e[t].apply(this,arguments)}:h[t]=e[t])}),h.$model=l,h.hasOwnProperty=function(t){return t in h.$model},o=!1,h}var lt=Object.defineProperty;try{lt({},"_",{value:"x"});var ut=Object.defineProperties}catch(t){"__defineGetter__"in Object&&(lt=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t},ut=function(t,e){for(var n in e)e.hasOwnProperty(n)&&lt(t,n,e[n]);return t})}var ct={UNKNOWN:0,WEBGL:1,CANVAS:2},ft={POLY:0,RECT:1,CIRC:2,ELIP:3},dt=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin"],pt=["lineWidth","strokeAlpha","strokeStyle","fillStyle","fillAlpha","globalAlpha","shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur"],vt=function(t,e,n,i){var r=t[0],a=t[1],s=t[2],o=t[3],h=Math.max(i,3),t=0,i=r;return!(a+h<n&&o+h<n||n<a-h&&n<o-h||r+h<e&&s+h<e||e<r-h&&e<s-h)&&(r===s?Math.abs(e-r)<=h/2:((t=(a-o)/(r-s))*e-n+(i=(r*o-s*a)/(r-s)))*(t*e-n+i)/(t*t+1)<=h/2*h/2)};var gt={RESOLUTION:"undefined"!=typeof window?window.devicePixelRatio:1,TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,FILTER_RESOLUTION:1,SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!0,forceFXAA:!1,autoResize:!1,transparent:!0,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump"},yt=function(){function i(t){var e;c(this,i),(e=o(this,l(i).call(this,t)))._transform=null,e.worldTransform=null,e._transformChange=!1,e._heartBeatNum=0,e.stage=null,e.parent=null,e.xyToInt=!("xyToInt"in t)||t.xyToInt,e.moveing=!1,e.clip=null,e.context=e._createContext(t),e.type=t.type||"DisplayObject",e.id=t.id||F.createId(e.type),e._trackList=[],e.init.apply(a(e),arguments),e._updateTransform(),e._tweens=[];var n=a(e);return e.on("destroy",function(){n.cleanAnimates()}),e}return d(i,q.Dispatcher),h(i,[{key:"init",value:function(){}},{key:"clipTo",value:function(t){(this.clip=t).isClip=!0}},{key:"_createContext",value:function(t){var r=this,e=t.context||{},e={width:e.width||0,height:e.height||0,x:e.x||0,y:e.y||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1,scaleOrigin:e.scaleOrigin||{x:0,y:0},rotation:e.rotation||0,rotateOrigin:e.rotateOrigin||{x:0,y:0},visible:e.visible||!0,globalAlpha:e.globalAlpha||1};return _.extend(!0,e,t.context),r._notWatch=!1,r._noHeart=!1,e.$watch=function(t,e,n){var i=r;i.context&&("globalGalpha"==t&&(i._globalAlphaChange=!0),-1<_.indexOf(dt,t)&&(i._updateTransform(),i._transformChange=!0),i._notWatch||(i.$watch&&(i._notWatch=!0,i.$watch(t,e,n),i._notWatch=!1),i._noHeart||i.heartBeat({convertType:"context",shape:i,name:t,value:e,preValue:n})))},ht(e)}},{key:"track",value:function(t){-1==_.indexOf(this._trackList,t)&&this._trackList.push(t)}},{key:"untrack",value:function(t){t=_.indexOf(this._trackList,t);-1<t&&this._trackList.splice(t,1)}},{key:"clone",value:function(t){var e={id:this.id,context:_.clone(this.context.$model),isClone:!0},n="text"==this.type?new this.constructor(this.text,e):new this.constructor(e);return n.id=e.id,this.children&&(n.children=this.children),this.graphics&&(n.graphics=this.graphics.clone()),t||(n.id=F.createId(n.type)),n}},{key:"heartBeat",value:function(t){var e=this.getStage();e&&(this._heartBeatNum++,e.heartBeat&&e.heartBeat(t))}},{key:"getCurrentWidth",value:function(){return Math.abs(this.context.$model.width*this.context.$model.scaleX)}},{key:"getCurrentHeight",value:function(){return Math.abs(this.context.$model.height*this.context.$model.scaleY)}},{key:"getStage",value:function(){if(this.stage)return this.stage;var t=this;if("stage"!=t.type){for(;t.parent&&"stage"!=(t=t.parent).type;);if("stage"!==t.type)return!1}return this.stage=t}},{key:"localToGlobal",value:function(t,e){t=t||new Y(0,0);e=this.getConcatenatedMatrix(e);if(null==e)return Y(0,0);t=new G(1,0,0,1,t.x,t.y);return t.concat(e),new Y(t.tx,t.ty)}},{key:"globalToLocal",value:function(t,e){if(t=t||new Y(0,0),"stage"==this.type)return t;e=this.getConcatenatedMatrix(e);if(null==e)return new Y(0,0);e.invert();t=new G(1,0,0,1,t.x,t.y);return t.concat(e),new Y(t.tx,t.ty)}},{key:"localToTarget",value:function(t,e){t=localToGlobal(t);return e.globalToLocal(t)}},{key:"getConcatenatedMatrix",value:function(t){for(var e=new G,n=this;null!=n;n=n.parent)if(e.concat(n._transform),!n.parent||t&&n.parent&&n.parent==t||n.parent&&"stage"==n.parent.type)return e;return e}},{key:"setEventEnable",value:function(t){return!!_.isBoolean(t)&&(this._eventEnabled=t,!0)}},{key:"getIndex",value:function(){if(this.parent)return _.indexOf(this.parent.children,this)}},{key:"toBack",value:function(t){if(this.parent){var e=this.getIndex(),n=0;if(_.isNumber(t)){if(0==t)return;n=e-t}e=this.parent.children.splice(e,1)[0];n<0&&(n=0),this.parent.addChildAt(e,n)}}},{key:"toFront",value:function(t){if(this.parent){var e=this.getIndex(),n=this.parent.children.length,i=n;if(_.isNumber(t)){if(0==t)return;i=e+t+1}e=this.parent.children.splice(e,1)[0];n<i&&(i=n),this.parent.addChildAt(e,i-1)}}},{key:"_updateTransform",value:function(){var t=new G;t.identity();var e=this.context;1===e.scaleX&&1===e.scaleY||(n=new Y(e.scaleOrigin),t.translate(-n.x,-n.y),t.scale(e.scaleX,e.scaleY),t.translate(n.x,n.y));var n,i,r,a=e.rotation;return a&&(n=new Y(e.rotateOrigin),t.translate(-n.x,-n.y),t.rotate(a%360*Math.PI/180),t.translate(n.x,n.y)),this.xyToInt&&!this.moveing?(i=parseInt(e.x),r=parseInt(e.y),parseInt(e.lineWidth,10)%2==1&&e.strokeStyle&&(i+=.5,r+=.5)):(i=e.x,r=e.y),0==i&&0==r||t.translate(i,r),this._transform=t}},{key:"setWorldTransform",value:function(){var t=new G;return t.concat(this._transform),this.parent&&t.concat(this.parent.worldTransform),this.worldTransform=t,this.worldTransform}},{key:"getChildInPoint",value:function(t){var e=!1,n=t.x,i=t.y;if(this.worldTransform&&(t=this.worldTransform.clone().invert(),r=[n*gt.RESOLUTION,i*gt.RESOLUTION],n=(r=t.mulVector(r))[0],i=r[1]),this.graphics&&(e=this.containsPoint({x:n,y:i})),"text"!=this.type)return e;var r=this.getRect();return!(!r.width||!r.height)&&(e=n>=r.x&&n<=r.x+r.width&&(0<=r.height&&i>=r.y&&i<=r.y+r.height||r.height<0&&i<=r.y&&i>=r.y+r.height))}},{key:"containsPoint",value:function(t){for(var e=!1,n=0;n<this.graphics.graphicsData.length;++n){var i=this.graphics.graphicsData[n];if(i.shape){if(i.hasFill()&&i.shape.contains(t.x,t.y)&&(e=!0))break;if(i.hasLine()&&i.shape.points&&(e=function(t,e,n){for(var i=t.shape.points,r=t.lineWidth,a=!1,s=0;s<i.length&&!(a=vt(i.slice(s,s+4),e,n,r));++s)s+=1;return a}(i,t.x,t.y)))break}}return e}},{key:"animate",value:function(t,e,n){if(n=n||this.context){var i,r=t,a=null;for(i in r)_.isObject(r[i])?this.animate(r[i],_.extend({},e),n[i]):isNaN(r[i])&&""!==r[i]&&null!==r[i]?(n[i]=r[i],delete r[i]):(a=a||{})[i]=n[i];if(a){(e=e||{}).from=a,e.to=r;var s,o=this,h=function(){};e.onUpdate&&(h=e.onUpdate),e.onUpdate=function(t){if(!n&&s)return ot.destroyTween(s),void(s=null);for(var e in t)n[e]=t[e];h.apply(o,[t])};var l=function(){};return e.onComplete&&(l=e.onComplete),e.onComplete=function(t){l.apply(o,arguments),o._removeTween(s)},e.onStop=function(){o._removeTween(s)},e.desc="tweenType:DisplayObject.animate__id:"+this.id+"__objectType:"+this.type,s=ot.registTween(e),this._tweens.push(s),s}}}},{key:"_removeTween",value:function(t){for(var e=0;e<this._tweens.length;e++)if(t==this._tweens[e]){this._tweens.splice(e,1);break}}},{key:"removeAnimate",value:function(t){t.stop(),this._removeTween(t)}},{key:"cleanAnimates",value:function(){this._cleanAnimates()}},{key:"_cleanAnimates",value:function(){for(;this._tweens.length;)this._tweens.shift().stop()}},{key:"remove",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"destroy",value:function(){this._destroy()}},{key:"_destroy",value:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}]),i}(),_t=function(){function s(t){return c(this,s),(t=o(this,l(s).call(this,t))).children=[],t.mouseChildren=[],t._eventEnabled=!0,t}return d(s,yt),h(s,[{key:"addChild",value:function(t,e){if(t)return-1!=this.getChildIndex(t)?t.parent=this:(t.parent&&t.parent.removeChild(t),void 0===e&&(e=this.children.length),this.children.splice(e,0,t),(t.parent=this).heartBeat&&this.heartBeat({convertType:"children",target:t,src:this}),this._afterAddChild&&this._afterAddChild(t)),t}},{key:"addChildAt",value:function(t,e){return this.addChild(t,e)}},{key:"removeChild",value:function(t){return this.removeChildAt(_.indexOf(this.children,t))}},{key:"removeChildAt",value:function(t){if(t<0||t>this.children.length-1)return!1;var e=this.children[t];return null!=e&&(e.parent=null),this.children.splice(t,1),this.heartBeat&&this.heartBeat({convertType:"children",target:e,src:this}),this._afterDelChild&&this._afterDelChild(e,t),e}},{key:"removeChildById",value:function(t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].id==t)return this.removeChildAt(e);return!1}},{key:"removeAllChildren",value:function(){for(;0<this.children.length;)this.removeChildAt(0)}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).destroy(),t--,e--;this._destroy()}},{key:"cleanAnimates",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).cleanAnimates();this._cleanAnimates()}},{key:"getChildById",value:function(t,e){if(e)return null;for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].id==t)return this.children[n];return null}},{key:"getChildAt",value:function(t){return t<0||t>this.children.length-1?null:this.children[t]}},{key:"getChildIndex",value:function(t){return _.indexOf(this.children,t)}},{key:"setChildIndex",value:function(t,e){var n;t.parent!=this||e!=(n=_.indexOf(this.children,t))&&(this.children.splice(n,1),this.children.splice(e,0,t))}},{key:"getNumChildren",value:function(){return this.children.length}},{key:"getObjectsUnderPoint",value:function(t,e){for(var n=[],i=this.children.length-1;0<=i;i--){var r,a=this.children[i];if(null!=a&&a.context.$model.visible)if(a instanceof s)a._eventEnabled&&a.mouseChildren&&0<a.getNumChildren()&&(0<(r=a.getObjectsUnderPoint(t)).length&&(n=n.concat(r)));else if((a._eventEnabled||a.dragEnabled)&&a.getChildInPoint(t)&&(n.push(a),null!=e&&!isNaN(e)&&n.length==e))return n}return n}}]),s}(),mt=function(){function e(t){return c(this,e),t.type="stage",(t=o(this,l(e).call(this,t))).canvas=null,t.ctx=null,t.stageRending=!1,t._isReady=!1,t}return d(e,_t),h(e,[{key:"initStage",value:function(t,e,n){this.canvas=t;t=this.context;t.width=e,t.height=n,t.scaleX=F._devicePixelRatio,t.scaleY=F._devicePixelRatio,this._isReady=!0}},{key:"heartBeat",value:function(t){this._isReady&&((t=t||{}).stage=this).parent&&this.parent.heartBeat(t)}}]),e}(),wt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ct.UNKNOWN,e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;if(c(this,r),this.type=t,this.app=e,n)for(var i in gt.RENDER_OPTIONS)void 0===n[i]&&(n[i]=gt.RENDER_OPTIONS[i]);else n=gt.RENDER_OPTIONS;this.options=n,this.requestAid=null,this._heartBeat=!1,this._preRenderTime=0}return h(r,[{key:"startEnter",value:function(){var t=this;t.requestAid||(t.requestAid=ot.registFrame({id:"enterFrame",task:function(){t.enterFrame.apply(t)}}))}},{key:"enterFrame",value:function(){var t=this;t.requestAid=null,F.now=(new Date).getTime(),t._heartBeat&&(this.app.children.length&&t.render(this.app),t._heartBeat=!1,t._preRenderTime=(new Date).getTime())}},{key:"_convertCanvax",value:function(e){_.each(this.app.children,function(t){t.context[e.name]=e.value})}},{key:"heartBeat",value:function(t){var n=this;if(t){if("context"==t.convertType){var e=t.stage,i=t.shape;t.name,t.value,t.preValue;if("canvax"==i.type)n._convertCanvax(t);else if(n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}),i){if(n.app.convertStages[e.id].convertShapes[i.id])return;n.app.convertStages[e.id].convertShapes[i.id]={shape:i,convertType:t.convertType}}}"children"==t.convertType&&(i=t.target,!(e=t.src.getStage())&&"stage"!=i.type||(e=e||i,n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}))),t.convertType||(e=t.stage,n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}))}else _.each(n.app.children,function(t,e){n.app.convertStages[t.id]={stage:t,convertShapes:{}}});n._heartBeat?n._heartBeat=!0:(n._heartBeat=!0,n.startEnter())}}]),r}(),xt=function(){function e(t){c(this,e),this.renderer=t}return h(e,[{key:"render",value:function(t,e,n,i){this.renderer;for(var r=t.graphics.graphicsData,a=e.ctx,s=0;s<r.length;s++){var o,h,l,u,c,f,d,p=r[s],v=p.shape,g=p.fillStyle,y=p.strokeStyle,_=p.hasFill()&&p.fillAlpha&&!i,m=p.hasLine()&&p.strokeAlpha&&!i;a.lineWidth=p.lineWidth,a.shadowColor=p.shadowColor,a.shadowBlur=p.shadowBlur,a.shadowOffsetX=p.shadowOffsetX,a.shadowOffsetY=p.shadowOffsetY,p.type===ft.POLY?(a.beginPath(),this.renderPolygon(v.points,v.closed,a,i),_&&(a.globalAlpha=p.fillAlpha*n,a.fillStyle=g,a.fill()),m&&(a.globalAlpha=p.strokeAlpha*n,a.strokeStyle=y,_&&p.shadowBlur&&(a.shadowBlur=0),a.stroke())):p.type===ft.RECT?(i&&a.rect(v.x,v.y,v.width,v.height),_&&(a.globalAlpha=p.fillAlpha*n,a.fillStyle=g,a.fillRect(v.x,v.y,v.width,v.height)),m&&(a.globalAlpha=p.strokeAlpha*n,a.strokeStyle=y,_&&p.shadowBlur&&(a.shadowBlur=0),a.strokeRect(v.x,v.y,v.width,v.height))):p.type===ft.CIRC?(a.beginPath(),a.arc(v.x,v.y,v.radius,0,2*Math.PI),a.closePath(),_&&(a.globalAlpha=p.fillAlpha*n,a.fillStyle=g,a.fill()),m&&(a.globalAlpha=p.strokeAlpha*n,a.strokeStyle=y,_&&p.shadowBlur&&(a.shadowBlur=0),a.stroke())):p.type===ft.ELIP&&(f=2*v.width,d=2*v.height,o=v.x-f/2,h=v.y-d/2,a.beginPath(),l=f/2*.5522848,u=d/2*.5522848,c=o+f,v=h+d,f=o+f/2,d=h+d/2,a.moveTo(o,d),a.bezierCurveTo(o,d-u,f-l,h,f,h),a.bezierCurveTo(f+l,h,c,d-u,c,d),a.bezierCurveTo(c,d+u,f+l,v,f,v),a.bezierCurveTo(f-l,v,o,d+u,o,d),a.closePath(),_&&(a.globalAlpha=p.fillAlpha*n,a.fillStyle=g,a.fill()),m&&(a.globalAlpha=p.strokeAlpha*n,a.strokeStyle=y,_&&p.shadowBlur&&(a.shadowBlur=0),a.stroke()))}}},{key:"renderPolygon",value:function(t,e,n,i){n.moveTo(t[0],t[1]);for(var r=1;r<t.length/2;++r)n.lineTo(t[2*r],t[2*r+1]);(e||i)&&n.closePath()}}]),e}(),bt=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return c(this,n),(e=o(this,l(n).call(this,ct.CANVAS,t,e))).CGR=new xt(a(e)),e}return d(n,wt),h(n,[{key:"render",value:function(t){var e=this;e.app=t,_.each(_.values(t.convertStages),function(t){e.renderStage(t.stage)}),t.convertStages={}}},{key:"renderStage",value:function(t){t.ctx||(t.ctx=t.canvas.getContext("2d")),t.stageRending=!0,t.setWorldTransform(),this._clear(t),this._render(t,t,t.context.globalAlpha),t.stageRending=!1}},{key:"_render",value:function(t,e,n){var i=t.ctx;if(i){var r=e.context.$model;if(e.worldTransform||e.fire("render"),(!e.worldTransform||e._transformChange||e.parent&&e.parent._transformChange)&&(e.setWorldTransform(),e.fire("transform"),e._transformChange=!0),n*=r.globalAlpha,r.visible&&!e.isClip){var a=e.worldTransform.toArray();if(a){i.setTransform.apply(i,a);var s=!1;if(e.clip&&e.clip.graphics&&(a=e.clip,i.save(),s=!0,a.worldTransform&&!a._transformChange&&!a.parent._transformChange||(a.setWorldTransform(),a._transformChange=!0),i.setTransform.apply(i,a.worldTransform.toArray()),a.graphics.graphicsData.length||a._draw(a.graphics),this.CGR.render(a,t,n,s),a._transformChange=!1,i.clip()),e.graphics&&(e.graphics.graphicsData.length||e._draw(e.graphics),n&&(i.setLineDash([]),r.lineType&&"solid"!=r.lineType&&i.setLineDash(r.lineDash),this.CGR.render(e,t,n))),"text"==e.type&&e.render(i,n),e.children)for(var o=0,h=e.children.length;o<h;o++)this._render(t,e.children[o],n);e._transformChange=!1,s&&i.restore()}}}}},{key:"_clear",value:function(t){var e=t.ctx;e.setTransform.apply(e,t.worldTransform.toArray()),e.clearRect(0,0,this.app.width,this.app.height)}}]),n}();var kt=function(){function r(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};c(this,r),t.type="canvax",(e=o(this,l(r).call(this,t)))._cid=(new Date).getTime()+"_"+Math.floor(100*Math.random()),e.el=B.query(t.el),e.width=parseInt("width"in t||e.el.offsetWidth,10),e.height=parseInt("height"in t||e.el.offsetHeight,10);var i=B.createView(e.width,e.height,e._cid);return e.view=i.view,e.stageView=i.stageView,e.domView=i.domView,e.el.innerHTML="",e.el.appendChild(e.view),e.viewOffset=B.offset(e.view),e.lastGetRO=0,e.webGL=t.webGL,e.renderer=(t=a(e),new bt(t,n)),e.event=null,e.convertStages={},e.context.$model.width=e.width,e.context.$model.height=e.height,e._bufferStage=null,e._creatHoverStage(),e.worldTransform=(new G).identity(),e}return d(r,_t),h(r,[{key:"registEvent",value:function(t){return this.event=new q.Handler(this,t),this.event.init(),this.event}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++){var n=this.children[t];n.destroy(),n.canvas=null,n.ctx=null,n=null,t--,e--}try{this.view.removeChild(this.stageView),this.view.removeChild(this.domView),this.el.removeChild(this.view)}catch(t){}this.el.innerHTML="",this.event=null,this._bufferStage=null}},{key:"resize",value:function(t){this.width=parseInt(t&&"width"in t||this.el.offsetWidth,10),this.height=parseInt(t&&"height"in t||this.el.offsetHeight,10),this.viewOffset=B.offset(this.view),this.context.$model.width=this.width,this.context.$model.height=this.height;var n=this;_.each(this.children,function(t,e){t.context.$model.width=n.width,t.context.$model.height=n.height,(t=t.canvas).style.width=n.width+"px",t.style.height=n.height+"px",t.setAttribute("width",n.width*F._devicePixelRatio),t.setAttribute("height",n.height*F._devicePixelRatio)}),this.stageView.style.width=this.width+"px",this.stageView.style.height=this.height+"px",this.domView.style.width=this.width+"px",this.domView.style.height=this.height+"px",this.heartBeat()}},{key:"getHoverStage",value:function(){return this._bufferStage}},{key:"_creatHoverStage",value:function(){this._bufferStage=new mt({id:"activCanvas"+(new Date).getTime(),context:{width:this.context.$model.width,height:this.context.$model.height}}),this._bufferStage._eventEnabled=!1,this.addChild(this._bufferStage)}},{key:"updateViewOffset",value:function(){var t=(new Date).getTime();1e3<t-this.lastGetRO&&(this.viewOffset=B.offset(this.view),this.lastGetRO=t)}},{key:"_afterAddChild",value:function(t,e){var n=t.canvas||B.createCanvas(this.context.$model.width,this.context.$model.height,t.id);1==this.children.length?this.stageView.appendChild(n):1<this.children.length&&(void 0===e?this.stageView.insertBefore(n,this._bufferStage.canvas):e>=this.children.length-1?this.stageView.appendChild(n):this.stageView.insertBefore(n,this.children[e].canvas)),F.initElement(n),t.initStage(n,this.context.$model.width,this.context.$model.height)}},{key:"_afterDelChild",value:function(t){try{this.stageView.removeChild(t.canvas)}catch(t){}}},{key:"heartBeat",value:function(t){0<this.children.length&&this.renderer.heartBeat(t)}},{key:"toDataURL",value:function(){var t=B.createCanvas(this.width,this.height,"curr_base64_canvas"),e=t.getContext("2d");return _.each(this.children,function(t){e.drawImage(t.canvas,0,0)}),t.toDataURL()}}]),r}(),Tt=function(){function e(t){return c(this,e),(t=F.checkOpt(t)).type="sprite",o(this,l(e).call(this,t))}return d(e,_t),e}(),Ct=function(){function u(t,e,n,i,r,a,s,o,h,l){c(this,u),this.lineWidth=t,this.strokeStyle=e,this.strokeAlpha=n,this.fillStyle=i,this.fillAlpha=r,this.shadowOffsetX=a,this.shadowOffsetY=s,this.shadowBlur=o,this.shadowColor=h,this.shape=l,this.type=l.type,this.holes=[],this.fill=!0,this.line=!0}return h(u,[{key:"clone",value:function(){var t=new u(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.shape);return t.fill=this.fill,t.line=this.line,t}},{key:"addHole",value:function(t){this.holes.push(t)}},{key:"synsStyle",value:function(t){this.line&&(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha),this.fill&&(this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha),this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor}},{key:"hasFill",value:function(){return this.fillStyle&&this.fill&&void 0!==this.shape.closed&&this.shape.closed}},{key:"hasLine",value:function(){return this.strokeStyle&&this.lineWidth&&this.line}},{key:"destroy",value:function(){this.shape=null,this.holes=null}}]),u}(),At={},Pt={},St=Array.prototype.join;function Ot(t,e,n,i,r,a,s){var o=St.call(arguments);if(At[o])return At[o];var h=Math.PI,l=s*h/180,u=Math.sin(l),c=Math.cos(l),f=0,d=0,p=-c*t*.5-u*e*.5,v=-c*e*.5+u*t*.5,g=(n=Math.abs(n))*n,y=(i=Math.abs(i))*i,_=v*v,m=p*p,w=g*y-g*_-y*m,s=0;w<0?(n*=l=Math.sqrt(1-w/(g*y)),i*=l):s=(r===a?-1:1)*Math.sqrt(w/(g*_+y*m));var m=s*n*v/i,s=-s*i*p/n,x=c*m-u*s+.5*t,b=u*m+c*s+.5*e,k=Et(1,0,(p-m)/n,(v-s)/i),s=Et((p-m)/n,(v-s)/i,(-p-m)/n,(-v-s)/i);0===a&&0<s?s-=2*h:1===a&&s<0&&(s+=2*h);for(var T=Math.ceil(Math.abs(s/h*2)),C=[],A=s/T,P=8/3*Math.sin(A/4)*Math.sin(A/4)/Math.sin(A/2),S=k+A,O=0;O<T;O++)C[O]=function(t,e,n,i,r,a,s,o,h,l,u){var c=St.call(arguments);if(Pt[c])return Pt[c];var f=Math.cos(t),d=Math.sin(t),t=Math.cos(e),e=Math.sin(e),s=n*r*t-i*a*e+s,o=i*r*t+n*a*e+o,l=l+h*(-n*r*d-i*a*f),d=u+h*(-i*r*d+n*a*f),f=s+h*(n*r*e+i*a*t),t=o+h*(i*r*e-n*a*t);return Pt[c]=[l,d,f,t,s,o],Pt[c]}(k,S,c,u,n,i,x,b,P,f,d),f=C[O][4],d=C[O][5],k=S,S+=A;return At[o]=C}function Et(t,e,n,i){t=Math.atan2(e,t),n=Math.atan2(i,n);return t<=n?n-t:2*Math.PI-(t-n)}var It=function(t,e,n,i){for(var r=i[0],a=i[1],s=i[2],o=i[3],h=i[4],l=[[],[],[],[]],u=Ot(i[5]-e,i[6]-n,r,a,o,h,s),c=0,f=u.length;c<f;c++)l[c][0]=u[c][0]+e,l[c][1]=u[c][1]+n,l[c][2]=u[c][2]+e,l[c][3]=u[c][3]+n,l[c][4]=u[c][4]+e,l[c][5]=u[c][5]+n,t.bezierCurveTo.apply(t,l[c])},Mt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;c(this,r),this.x=t,this.y=e,this.width=n,this.height=i,this.type=ft.RECT,this.closed=!0}return h(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.height*e<0||this.width*t<0)&&(t>=this.x&&t<=this.x+this.width&&(0<=this.height&&e>=this.y&&e<=this.y+this.height||this.height<0&&e<=this.y&&e>=this.y+this.height))}}]),r}(),Lt=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;c(this,i),this.x=t,this.y=e,this.radius=n,this.type=ft.CIRC,this.closed=!0}return h(i,[{key:"clone",value:function(){return new i(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,t=this.x-t,e=this.y-e;return(t*=t)+(e*=e)<=n}},{key:"getBounds",value:function(){return new Mt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),i}(),Dt=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;c(this,r),this.x=t,this.y=e,this.width=n,this.height=i,this.type=ft.ELIP,this.closed=!0}return h(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;t=(t-this.x)/this.width,e=(e-this.y)/this.height;return(t*=t)+(e*=e)<=1}},{key:"getBounds",value:function(){return new Mt(this.x-this.width,this.y-this.height,this.width,this.height)}}]),r}(),Rt=function(){function o(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];c(this,o);var i=e[0];if(Array.isArray(i)&&(e=i),i&&"x"in i&&"y"in i){for(var r=[],a=0,s=e.length;a<s;a++)r.push(e[a].x,e[a].y);e=r}this.closed=!0,this.points=e,this.type=ft.POLY}return h(o,[{key:"clone",value:function(){return new o(this.points.slice())}},{key:"close",value:function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1]),this.closed=!0}},{key:"contains",value:function(t,e){return this._isInsidePolygon_WindingNumber(t,e)}},{key:"_isInsidePolygon_WindingNumber",value:function(t,e){for(var n,i=this.points,r=0,a=i[1]>e,s=3;s<i.length;s+=2)(n=a)==(a=i[s]>e)||0<(n=(n?1:0)-(a?1:0))*((i[s-3]-t)*(i[+s]-e)-(i[s-2]-e)*(i[s-1]-t))&&(r+=n);return r}}]),o}();var Bt=function(){function n(t){c(this,n),this.lineWidth=1,this.strokeStyle=null,this.strokeAlpha=1,this.fillStyle=null,this.fillAlpha=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="black",this.graphicsData=[],this.currentPath=null,this.dirty=0,this.clearDirty=0,this._webGL={},this.worldAlpha=1,this.tint=16777215,this.Bound={x:0,y:0,width:0,height:0}}return h(n,[{key:"setStyle",value:function(t){t=t.$model;this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha*t.globalAlpha,this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha*t.globalAlpha,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor;var n=this;this.graphicsData.length&&_.each(this.graphicsData,function(t,e){t.synsStyle(n)})}},{key:"clone",value:function(){for(var t,e=(t=new n).dirty=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t}},{key:"moveTo",value:function(t,e){e=new Rt([t,e]);return e.closed=!1,this.drawShape(e),this}},{key:"lineTo",value:function(t,e){return this.currentPath?(this.currentPath.shape.points.push(t,e),this.dirty++):this.moveTo(0,0),this}},{key:"quadraticCurveTo",value:function(t,e,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r=this.currentPath.shape.points;0===r.length&&this.moveTo(0,0);for(var a=r[r.length-2],s=r[r.length-1],o=1;o<=20;++o){var h=o/20,l=a+(t-a)*h,u=s+(e-s)*h;r.push(l+(t+(n-t)*h-l)*h,u+(e+(i-e)*h-u)*h)}return this.dirty++,this}},{key:"bezierCurveTo",value:function(t,e,n,i,r,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,o=s[s.length-2],h=s[s.length-1];return s.length-=2,function(t,e,n,i,r,a,s,o,h){var l,u,c,f,d,p=8<arguments.length&&void 0!==h?h:[];p.push(t,e);for(var v,g=1;g<=20;++g)c=(u=(l=1-(v=g/20))*l)*l,d=(f=v*v)*v,p.push(c*t+3*u*v*n+3*l*f*r+d*s,c*e+3*u*v*i+3*l*f*a+d*o)}(o,h,t,e,n,i,r,a,s),this.dirty++,this}},{key:"arcTo",value:function(t,e,n,i,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var a,s,o,h=this.currentPath.shape.points,l=h[h.length-2],u=h[h.length-1]-e,c=l-t,f=i-e,d=n-t,p=Math.abs(u*d-c*f);return p<1e-8||0===r?h[h.length-2]===t&&h[h.length-1]===e||h.push(t,e):(s=u*u+c*c,o=f*f+d*d,a=u*f+c*d,n=(l=r*Math.sqrt(s)/p)*d+(i=r*Math.sqrt(o)/p)*c,h=l*f+i*u,s=c*(i+(p=l*a/s)),p=u*(i+p),o=d*(l+(a=i*a/o)),a=f*(l+a),s=Math.atan2(p-h,s-n),o=Math.atan2(a-h,o-n),this.arc(n+t,h+e,r,s,o,d*u<c*f)),this.dirty++,this}},{key:"arc",value:function(t,e,n,i,r){var a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(i===r)return this;!a&&r<=i?r+=2*Math.PI:a&&i<=r&&(i+=2*Math.PI);var s=r-i,o=48*Math.ceil(Math.abs(s)/(2*Math.PI));if(0==s)return this;var a=t+Math.cos(i)*n,r=e+Math.sin(i)*n,h=this.currentPath?this.currentPath.shape.points:null;h?h[h.length-2]===a&&h[h.length-1]===r||h.push(a,r):(this.moveTo(a,r),h=this.currentPath.shape.points);for(var l=s/(2*o),u=2*l,c=Math.cos(l),f=Math.sin(l),d=o-1,p=d%1/d,v=0;v<=d;++v){var g=l+i+u*(v+p*v),y=Math.cos(g),g=-Math.sin(g);h.push((c*y+f*g)*n+t,(c*-g+f*y)*n+e)}return this.dirty++,this}},{key:"drawRect",value:function(t,e,n,i){return this.drawShape(new Mt(t,e,n,i)),this}},{key:"drawCircle",value:function(t,e,n){return this.drawShape(new Lt(t,e,n)),this}},{key:"drawEllipse",value:function(t,e,n,i){return this.drawShape(new Dt(t,e,n,i)),this}},{key:"drawPolygon",value:function(t){var e=!0;if((n=t)instanceof Rt&&(e=n.closed,n=n.points),!Array.isArray(n))for(var n=new Array(arguments.length),i=0;i<n.length;++i)n[i]=arguments[i];t=new Rt(n);return t.closed=e,this.drawShape(t),this}},{key:"clear",value:function(){return 0<this.graphicsData.length&&(this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this}},{key:"drawShape",value:function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.beginPath();t=new Ct(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,t);return this.graphicsData.push(t),t.type===ft.POLY&&(t.shape.closed=t.shape.closed,this.currentPath=t),this.dirty++,t}},{key:"beginPath",value:function(){this.currentPath=null}},{key:"closePath",value:function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this}},{key:"updateLocalBounds",value:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0;if(this.graphicsData.length)for(var r=0,a=0,s=0,o=0,h=0;h<this.graphicsData.length;h++){var l=this.graphicsData[h],u=l.type,c=l.lineWidth,f=l.shape;if(u===ft.RECT||u===ft.RREC)r=f.x-c/2,a=f.y-c/2,t=r<t?r:t,e=e<r+(s=f.width+c)?r+s:e,n=a<n?a:n,i=i<a+(o=f.height+c)?a+o:i;else if(u===ft.CIRC)r=f.x,a=f.y,t=r-(s=f.radius+c/2)<t?r-s:t,e=e<r+s?r+s:e,n=a-(o=f.radius+c/2)<n?a-o:n,i=i<a+o?a+o:i;else if(u===ft.ELIP)r=f.x,a=f.y,t=r-(s=f.width+c/2)<t?r-s:t,e=e<r+s?r+s:e,n=a-(o=f.height+c/2)<n?a-o:n,i=i<a+o?a+o:i;else for(var d,p,v,g,y,_,m,w,x=f.points,b=0;b+2<x.length;b+=2)r=x[b],a=x[b+1],d=x[b+2],p=x[b+3],v=Math.abs(d-r),g=Math.abs(p-a),o=c,(s=Math.sqrt(v*v+g*g))<1e-9||(t=(m=(d+r)/2)-(y=(o/s*g+v)/2)<t?m-y:t,e=e<m+y?m+y:e,n=(w=(p+a)/2)-(_=(o/s*v+g)/2)<n?w-_:n,i=i<w+_?w+_:i)}else i=n=e=t=0;return this.Bound={x:t,y:n,width:e-t,height:i-n},this}},{key:"getBound",value:function(){return this.updateLocalBounds().Bound}},{key:"destroy",value:function(t){for(var e,n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();for(e in this._webGL)for(var i=0;i<this._webGL[e].data.length;++i)this._webGL[e].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webGL=null}}]),n}(),Ft=function(){function n(t){c(this,n);var e={cursor:(t=F.checkOpt(t)).context.cursor||"default",fillAlpha:t.context.fillAlpha||1,fillStyle:t.context.fillStyle||null,lineCap:t.context.lineCap||"round",lineJoin:t.context.lineJoin||"round",miterLimit:t.context.miterLimit||null,strokeAlpha:t.context.strokeAlpha||1,strokeStyle:t.context.strokeStyle||null,lineType:t.context.lineType||"solid",lineDash:t.context.lineDash||[6,3],lineWidth:t.context.lineWidth||null,shadowOffsetX:t.context.shadowOffsetX||0,shadowOffsetY:t.context.shadowOffsetY||0,shadowBlur:t.context.shadowBlur||0,shadowColor:t.context.shadowColor||"#000000"},e=_.extend(!0,e,t.context);return t.context=e,void 0===t.id&&void 0!==t.type&&(t.id=F.createId(t.type)),(e=o(this,l(n).call(this,t)))._hoverClass=!1,e.hoverClone=!0,e.pointChkPriority=!0,e._eventEnabled=!1,e.dragEnabled=t.dragEnabled||!1,e._dragDuplicate=null,e.type=e.type||"shape",e.initCompProperty(t),e.isClone?e.graphics=null:(e.graphics=new Bt,e._draw(e.graphics)),e}return d(n,yt),h(n,[{key:"_draw",value:function(t){0==t.graphicsData.length&&(t.setStyle(this.context),this.draw(t))}},{key:"draw",value:function(){}},{key:"clearGraphicsData",value:function(){this.graphics.clear()}},{key:"$watch",value:function(t,e,n){-1<_.indexOf(pt,t)&&this.graphics.setStyle(this.context),this.watch(t,e,n)}},{key:"initCompProperty",value:function(t){for(var e in t)"id"!=e&&"context"!=e&&(this[e]=t[e])}},{key:"getBound",value:function(){return this.graphics.updateLocalBounds().Bound}}]),n}(),$t=function(){function n(t,e){return c(this,n),e.type="text",null==t&&(t=""),e.context=_.extend({font:"",fontSize:13,fontWeight:"normal",fontFamily:",sans-serif",textBaseline:"top",textAlign:"left",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},e.context),(e=o(this,l(n).call(this,e)))._reNewline=/\r?\n/,e.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],e.context.font=e._getFontDeclaration(),e.text=t.toString(),e.context.width=e.getTextWidth(),e.context.height=e.getTextHeight(),e}return d(n,yt),h(n,[{key:"$watch",value:function(t,e,n){0<=_.indexOf(this.fontProperts,t)&&(this.context[t]=e,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())}},{key:"_setContextStyle",value:function(t,e,n){for(var i in e)"textBaseline"!=i&&i in t&&(e[i]||_.isNumber(e[i]))&&("globalAlpha"==i?t.globalAlpha=n:t[i]=e[i])}},{key:"render",value:function(t,e){this._renderText(t,this._getTextLines(),e)}},{key:"resetText",value:function(t){this.text=t.toString(),this.heartBeat()}},{key:"getTextWidth",value:function(){var t=0;return F._pixelCtx&&(F._pixelCtx.save(),F._pixelCtx.font=this.context.$model.font,t=this._getTextWidth(F._pixelCtx,this._getTextLines()),F._pixelCtx.restore()),t}},{key:"getTextHeight",value:function(){return this._getTextHeight(F._pixelCtx,this._getTextLines())}},{key:"_getTextLines",value:function(){return this.text.split(this._reNewline)}},{key:"_renderText",value:function(t,e,n){t&&(t.save(),this._setContextStyle(t,this.context.$model,n),this._renderTextStroke(t,e),this._renderTextFill(t,e),t.restore())}},{key:"_getFontDeclaration",value:function(){var n=this,i=[];return _.each(this.fontProperts,function(t){var e=n.context[t];(e="fontSize"==t?parseFloat(e)+"px":e)&&i.push(e)}),i.join(" ")}},{key:"_renderTextFill",value:function(t,e){if(this.context.$model.fillStyle){this._boundaries=[];for(var n=0,i=0,r=e.length;i<r;i++)n+=this._getHeightOfLine(t,i,e),this._renderTextLine("fillText",t,e[i],0,this._getTopOffset()+n,i)}}},{key:"_renderTextStroke",value:function(t,e){if(t&&this.context.$model.strokeStyle&&this.context.$model.lineWidth){var n=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=e.length;i<r;i++)n+=this._getHeightOfLine(t,i,e),this._renderTextLine("strokeText",t,e[i],0,this._getTopOffset()+n,i);t.closePath(),t.restore()}}},{key:"_renderTextLine",value:function(t,e,n,i,r,a){if(r-=this._getHeightOfLine()/4,"justify"===this.context.$model.textAlign){var s=e.measureText(n).width,o=this.context.$model.width;if(s<o)for(var h=n.split(/\s+/),l=(o-e.measureText(n.replace(/\s+/g,"")).width)/(h.length-1),u=0,c=0,f=h.length;c<f;c++)this._renderChars(t,e,h[c],i+u,r,a),u+=e.measureText(h[c]).width+l;else this._renderChars(t,e,n,i,r,a)}else this._renderChars(t,e,n,i,r,a)}},{key:"_renderChars",value:function(t,e,n,i,r){e[t](n,0,r)}},{key:"_getHeightOfLine",value:function(){return this.context.$model.fontSize*this.context.$model.lineHeight}},{key:"_getTextWidth",value:function(t,e){for(var n=t.measureText(e[0]||"|").width,i=1,r=e.length;i<r;i++){var a=t.measureText(e[i]).width;n<a&&(n=a)}return n}},{key:"_getTextHeight",value:function(t,e){return this.context.$model.fontSize*e.length*this.context.$model.lineHeight}},{key:"_getTopOffset",value:function(){var t=0;switch(this.context.$model.textBaseline){case"top":t=0;break;case"middle":t=-this.context.$model.height/2;break;case"bottom":t=-this.context.$model.height}return t}},{key:"getRect",value:function(){var t=this.context,e=0,n=0;return"center"==t.textAlign&&(e=-t.width/2),"right"==t.textAlign&&(e=-t.width),"middle"==t.textBaseline&&(n=-t.height/2),{x:e,y:n="bottom"==t.textBaseline?-t.height:n,width:t.width,height:t.height}}}]),n}();function Nt(t,e){var n=0,i=0;1==arguments.length&&_.isObject(t)&&(t=t,_.isArray(t)?(n=t[0],i=t[1]):t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&(n=t.x,i=t.y)),this._axes=[n,i]}function jt(t,e,n,i,r,a,s){t=.25*(n-t),i=.25*(i-e);return(2*(e-n)+t+i)*s+(-3*(e-n)-2*t-i)*a+t*r+e}Nt.prototype={distance:function(t){var e=this._axes[0]-t._axes[0],t=this._axes[1]-t._axes[1];return Math.sqrt(e*e+t*t)}};var Wt={sin:{},cos:{}},Ut=Math.PI/180;function Ht(t,e){var n={points:t};_.isFunction(e)&&(n.smoothFilter=e);n=function(t){var e=t.points,n=t.isLoop,i=t.smoothFilter,r=e.length;if(1==r)return e;for(var a=[],s=0,o=new Nt(e[0]),h=null,l=1;l<r;l++)h=new Nt(e[l]),s+=o.distance(h),o=h;for(var o=null,h=null,u=(u=s/6)<r?r:u,l=0;l<u;l++){var c,f,d=l/(u-1)*(n?r:r-1),p=Math.floor(d),v=d-p,g=e[p%r],y=n?(c=e[(p-1+r)%r],f=e[(p+1)%r],e[(p+2)%r]):(c=e[0===p?p:p-1],f=e[r-2<p?r-1:p+1],e[r-3<p?r-1:p+2]),d=v*v,p=v*d,p=[jt(c[0],g[0],f[0],y[0],v,d,p),jt(c[1],g[1],f[1],y[1],v,d,p)];_.isFunction(i)&&i(p),a.push(p)}return a}(n);return t&&0<t.length&&n.push(t[t.length-1]),n}function Vt(t){return!t||_.isArray(t)&&2<=t.length&&(!_.isNumber(t[0])||!_.isNumber(t[1]))||"x"in t&&!_.isNumber(t.x)||"y"in t&&!_.isNumber(t.y)}var Xt={PI:Math.PI,sin:function(t,e){return t=(e?t*Ut:t).toFixed(4),void 0===Wt.sin[t]&&(Wt.sin[t]=Math.sin(t)),Wt.sin[t]},cos:function(t,e){return t=(e?t*Ut:t).toFixed(4),void 0===Wt.cos[t]&&(Wt.cos[t]=Math.cos(t)),Wt.cos[t]},degreeToRadian:function(t){return t*Ut},radianToDegree:function(t){return t/Ut},degreeTo360:function(t){var e=(360+t%360)%360;return e=0==e&&0!==t?360:e},getIsgonPointList:function(t,e){for(var n=[],i=2*Math.PI/t,r=-Math.PI/2,a=0,s=t;a<s;a++)n.push([e*Math.cos(r),e*Math.sin(r)]),r+=i;return n},getSmoothPointList:function(t,n){var i=[],r=t.length,a=[];return _.each(t,function(t,e){Vt(t)?(a.length&&(i=i.concat(Ht(a,n)),a=[]),i.push(t)):a.push(t),e==r-1&&a.length&&(i=i.concat(Ht(a,n)),a=[])}),i},isNotValibPoint:Vt,isValibPoint:function(t){return!Vt(t)}},qt=function(){function n(t){c(this,n),t=F.checkOpt(t);var e=_.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:F.__emptyFunc},t.context);return!t.isClone&&e.smooth&&(e.pointList=Xt.getSmoothPointList(e.pointList,e.smoothFilter)),t.context=e,t.type="brokenline",(t=o(this,l(n).call(this,t)))._pointList=e.pointList,t}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||("pointList"==t&&this.context.smooth&&(this.context.pointList=Xt.getSmoothPointList(e,this.context.smoothFilter),this._pointList=e),"smooth"==t&&(this.context.pointList=e?Xt.getSmoothPointList(this._pointList,this.context.smoothFilter):this._pointList),this.graphics.clear())}},{key:"draw",value:function(t){for(var e=this.context.pointList,n=!1,i=0,r=e.length;i<r;i++)var a=e[i],n=!!Xt.isValibPoint(a)&&(n?t.lineTo(a[0],a[1]):t.moveTo(a[0],a[1]),!0);return this}}]),n}(),Gt=function(){function e(t){return c(this,e),t=_.extend(!0,{type:"circle",xyToInt:!1,context:{r:0}},F.checkOpt(t)),o(this,l(e).call(this,t))}return d(e,Ft),h(e,[{key:"watch",value:function(t,e,n){"r"==t&&this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model.r;e<0&&(e=0),t.drawCircle(0,0,e)}}]),e}(),Yt=function(){function n(t){c(this,n);var e=_.extend(!0,{pointList:[],path:""},t.context);return t.context=e,t.__parsePathData=null,t.type="path",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"path"==t&&this.graphics.clear()}},{key:"_parsePathData",value:function(t){if(this.__parsePathData)return this.__parsePathData;if(!t)return[];this.__parsePathData=[];var t=_.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),e=this;return _.each(t,function(t){e.__parsePathData.push(e._parseChildPathData(t))}),this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(e=(e=(e=(e=e.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),o=0;o<n.length;o++)e=e.replace(new RegExp(n[o],"g"),"|"+n[o]);for(var i=e.split("|"),r=[],a=0,s=0,o=1;o<i.length;o++){var h=i[o],l=h.charAt(0),u=(h=(h=h.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");0<u.length&&""===u[0]&&u.shift();for(var c=0;c<u.length;c++)u[c]=parseFloat(u[c]);for(;0<u.length&&!isNaN(u[0]);){var f,d,p,v=null,g=[],y=a,_=s;switch(l){case"l":a+=u.shift(),s+=u.shift(),v="L",g.push(a,s);break;case"L":a=u.shift(),s=u.shift(),g.push(a,s);break;case"m":a+=u.shift(),s+=u.shift(),v="M",g.push(a,s),l="l";break;case"M":a=u.shift(),s=u.shift(),v="M",g.push(a,s),l="L";break;case"h":a+=u.shift(),v="L",g.push(a,s);break;case"H":a=u.shift(),v="L",g.push(a,s);break;case"v":s+=u.shift(),v="L",g.push(a,s);break;case"V":s=u.shift(),v="L",g.push(a,s);break;case"C":g.push(u.shift(),u.shift(),u.shift(),u.shift()),a=u.shift(),s=u.shift(),g.push(a,s);break;case"c":g.push(a+u.shift(),s+u.shift(),a+u.shift(),s+u.shift()),a+=u.shift(),s+=u.shift(),v="C",g.push(a,s);break;case"S":f=a,d=s,"C"===(p=r[r.length-1]).command&&(f=a+(a-p.points[2]),d=s+(s-p.points[3])),g.push(f,d,u.shift(),u.shift()),a=u.shift(),s=u.shift(),v="C",g.push(a,s);break;case"s":f=a,d=s,"C"===(p=r[r.length-1]).command&&(f=a+(a-p.points[2]),d=s+(s-p.points[3])),g.push(f,d,a+u.shift(),s+u.shift()),a+=u.shift(),s+=u.shift(),v="C",g.push(a,s);break;case"Q":g.push(u.shift(),u.shift()),a=u.shift(),s=u.shift(),g.push(a,s);break;case"q":g.push(a+u.shift(),s+u.shift()),a+=u.shift(),s+=u.shift(),v="Q",g.push(a,s);break;case"T":f=a,d=s,"Q"===(p=r[r.length-1]).command&&(f=a+(a-p.points[0]),d=s+(s-p.points[1])),a=u.shift(),s=u.shift(),v="Q",g.push(f,d,a,s);break;case"t":f=a,d=s,"Q"===(p=r[r.length-1]).command&&(f=a+(a-p.points[0]),d=s+(s-p.points[1])),a+=u.shift(),s+=u.shift(),v="Q",g.push(f,d,a,s);break;case"A":y=a,_=s,v="A",g=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),a=u.shift(),s=u.shift(),y,_];break;case"a":y=a,_=s,v="A",g=[u.shift(),u.shift(),u.shift(),u.shift(),u.shift(),a+=u.shift(),s+=u.shift(),y,_]}r.push({command:v||l,points:g})}"z"!==l&&"Z"!==l||r.push({command:"z",points:[]})}return r}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),n=0,i=e.length;n<i;n++)for(var r=0,a=e[n].length;r<a;r++){var s=e[n][r].command,o=e[n][r].points;switch(s){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":It(t,o[7],o[8],o);break;case"z":t.closePath()}}return this}}]),n}(),zt=function(){function e(t){c(this,e),t=_.extend(!0,{type:"droplet",context:{hr:0,vr:0}},F.checkOpt(t));t=o(this,l(e).call(this,t));return t.context.$model.path=t.createPath(),t}return d(e,Yt),h(e,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||(this.context.$model.path=this.createPath())}},{key:"createPath",value:function(){var t=this.context.$model,e="M 0 "+t.hr+" C "+t.hr+" "+t.hr+" "+3*t.hr/2+" "+-t.hr/3+" 0 "+-t.vr;return e+=" C "+3*-t.hr/2+" "+-t.hr/3+" "+-t.hr+" "+t.hr+" 0 "+t.hr+"z"}}]),e}(),Qt=function(){function e(t){return c(this,e),t=_.extend(!0,{type:"ellipse",context:{hr:0,vr:0}},F.checkOpt(t)),o(this,l(e).call(this,t))}return d(e,Ft),h(e,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||this.graphics.clear()}},{key:"draw",value:function(t){t.drawEllipse(0,0,2*this.context.$model.hr,2*this.context.$model.vr)}}]),e}(),Kt=function(){function i(t){c(this,i);var e,n=_.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:F.__emptyFunc},t.context);return t.isClone||(n.pointList[0],e=n.pointList.slice(-1)[0],n.smooth&&(n.pointList.unshift(e),n.pointList=Xt.getSmoothPointList(n.pointList))),t.context=n,t.type="polygon",o(this,l(i).call(this,t))}return d(i,Ft),h(i,[{key:"watch",value:function(t,e,n){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.pointList;if(!(e.length<2)){t.moveTo(e[0][0],e[0][1]);for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n][0],e[n][1]);t.closePath()}}}]),i}(),p=function(){function n(t){c(this,n);var e=_.extend(!0,{pointList:[],r:0,n:0},t.context);return e.pointList=Xt.getIsgonPointList(e.n,e.r),t.context=e,t.type="isogon",o(this,l(n).call(this,t))}return d(n,Kt),h(n,[{key:"watch",value:function(t,e,n){"r"!=t&&"n"!=t||(this.context.$model.pointList=Xt.getIsgonPointList(this.context.$model.n,this.context.$model.r)),"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}}]),n}(),S=function(){function n(t){c(this,n);var e=_.extend(!0,{start:{x:0,y:0},end:{x:0,y:0}},t.context);return t.context=e,t.type="line",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model;return t.moveTo(e.start.x,e.start.y),t.lineTo(e.end.x,e.end.y),this}}]),n}(),P=function(){function n(t){c(this,n);var e=_.extend(!0,{width:0,height:0,radius:[]},t.context);return t.context=e,t.type="rect",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"width"!=t&&"height"!=t&&"radius"!=t||this.graphics.clear()}},{key:"_buildRadiusPath",value:function(t){var e=this.context.$model,n=e.width,i=e.height,r=F.getCssOrderArr(e.radius),e=t,t=0<=i?-1:1;e.moveTo(parseInt(0+r[0]),parseInt(i)),e.lineTo(parseInt(0+n-r[1]),parseInt(i)),0!==r[1]&&e.quadraticCurveTo(0+n,i,parseInt(0+n),parseInt(i+r[1]*t)),e.lineTo(parseInt(0+n),parseInt(0-r[2]*t)),0!==r[2]&&e.quadraticCurveTo(0+n,0,parseInt(0+n-r[2]),parseInt(0)),e.lineTo(parseInt(0+r[3]),parseInt(0)),0!==r[3]&&e.quadraticCurveTo(0,0,parseInt(0),parseInt(0-r[3]*t)),e.lineTo(parseInt(0),parseInt(0+i+r[0]*t)),0!==r[0]&&e.quadraticCurveTo(0,0+i,parseInt(0+r[0]),parseInt(0+i))}},{key:"draw",value:function(t){var e=this.context.$model;e.radius.length?this._buildRadiusPath(t):t.drawRect(0,0,e.width,e.height),t.closePath()}}]),n}(),R=function(){function n(t){c(this,n);var e=_.extend(!0,{pointList:[],r0:0,r:0,startAngle:0,endAngle:0,clockwise:!1},t.context);return t.context=e,t.regAngle=[],t.isRing=!1,t.type="sector",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"r0"!=t&&"r"!=t&&"startAngle"!=t&&"endAngle"!=t&&"clockwise"!=t||(this.isRing=!1,this.graphics.clear())}},{key:"draw",value:function(t){var e=this.context.$model,n=void 0===e.r0?0:e.r0,i=e.r,r=Xt.degreeTo360(e.startAngle),a=Xt.degreeTo360(e.endAngle);e.startAngle!=e.endAngle&&Math.abs(e.startAngle-e.endAngle)%360==0&&(this.isRing=!0,r=0,a=360);r=Xt.degreeToRadian(r),a=Xt.degreeToRadian(a);this.isRing?0==e.r0?t.drawCircle(0,0,e.r):(e.fillStyle&&e.fillAlpha&&(t.beginPath(),t.arc(0,0,i,r,a,e.clockwise),0==e.r0?t.lineTo(0,0):t.arc(0,0,n,a,r,!e.clockwise),t.closePath(),t.currentPath.lineWidth=0,t.currentPath.strokeStyle=null,t.currentPath.strokeAlpha=0,t.currentPath.line=!1),e.lineWidth&&e.strokeStyle&&e.strokeAlpha&&(t.beginPath(),t.arc(0,0,i,r,a,e.clockwise),t.closePath(),t.currentPath.fillStyle=null,t.currentPath.fill=!1,t.beginPath(),t.arc(0,0,n,a,r,!e.clockwise),t.closePath(),t.currentPath.fillStyle=null,t.currentPath.fill=!1)):(t.beginPath(),t.arc(0,0,i,r,a,e.clockwise),0==e.r0?t.lineTo(0,0):t.arc(0,0,n,a,r,!e.clockwise),t.closePath())}}]),n}(),U=function(){function n(t){c(this,n);var e=_.extend(!0,{control:{x:0,y:0},point:{x:0,y:0},angle:null,theta:30,headlen:6,lineWidth:1,strokeStyle:"#666",fillStyle:null},t.context);return t.context=e,t.type="arrow",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t&&"theta"!=t&&"headlen"!=t&&"angle"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.control.x,i=e.control.y,r=e.point.x,a=e.point.y,s=null!=e.angle?e.angle-180:180*Math.atan2(i-a,n-r)/Math.PI,o=(s+e.theta)*Math.PI/180,i=(s-e.theta)*Math.PI/180,n=e.headlen*Math.cos(o),s=e.headlen*Math.sin(o),o=e.headlen*Math.cos(i),i=e.headlen*Math.sin(i),n=r+n,s=a+s;return t.moveTo(n,s),t.lineTo(r,a),t.lineTo(r+o,a+i),e.fillStyle&&(t.lineTo(n,s),t.closePath()),this}}]),n}(),V=function(){function n(t){c(this,n);var e=_.extend(!0,{innerRect:{width:0,height:0},includedAngle:60},t.context);return t.context=e,t.type="diamond",o(this,l(n).call(this,t))}return d(n,Ft),h(n,[{key:"watch",value:function(t,e,n){-1<["includedAngle"].indexOf(t)&&this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.innerRect,i=e.includedAngle/2*Math.PI/180,e=n.height/Math.tan(i),i=n.width*Math.tan(i),e=n.width+e,i=n.height+i;return t.moveTo(0,i/2),t.lineTo(e/2,0),t.lineTo(0,-i/2),t.lineTo(-e/2,0),t.lineTo(0,i/2),t.closePath(),this}}]),n}(),kt={version:"2.0.70",_:_,$:B,event:q,App:kt};return kt.Display={DisplayObject:yt,DisplayObjectContainer:_t,Stage:mt,Sprite:Tt,Shape:Ft,Point:Y,Text:$t},kt.Shapes={BrokenLine:qt,Circle:Gt,Droplet:zt,Ellipse:Qt,Isogon:p,Line:S,Path:Yt,Polygon:Kt,Rect:P,Sector:R,Arrow:U,Diamond:V},kt.AnimationFrame=ot,kt.utils=F,kt}();